let c=new Uint8ClampedArray(9109504),aa={size:()=>9109504,grow:()=>{},wasmByteMemory:c};
var ba=65536,ca=67584,da=ca+128,ea=da+23552,fa=ea+93184,ha=fa+196608,ia=ha+147456,ja=ia-ca+15360,ka=ia+15360,la=ka+131072,ma=la+131072,na=ma+131072,oa=na+131072,pa=oa+131072,qa=pa+131072,ra=qa+2560,sa=ra+8258560,ta=sa+65535+1,ua=Math.ceil(ta/1024/64)+1,e=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=
!1;a.enableAudioDebugging=!1;return a}();function va(a,b){a=1<<a&255;f.registerF=0<b?f.registerF|a:f.registerF&(255^a);return f.registerF}function k(a){va(7,a)}function l(a){va(6,a)}function m(a){va(5,a)}function n(a){va(4,a)}function wa(){return f.registerF>>7&1}function xa(){return f.registerF>>4&1}function ya(a,b){0<=b?m(0!==((a&15)+(b&15)&16)):m((Math.abs(b)&15)>(a&15))}function za(a,b){0<=b?n(a>(a+b&255)):n(Math.abs(b)>a)}
function Aa(a,b,d){d?(a=a^b^a+b,m(0!==(a&16)),n(0!==(a&256))):(d=a+b&65535,n(d<a),m(0!==((a^b^d)&4096)))}
var p=function(){function a(){}a.bgWhite=15921906;a.bgLightGrey=10526880;a.bgDarkGrey=5789784;a.bgBlack=526344;a.obj0White=15921906;a.obj0LightGrey=10526880;a.obj0DarkGrey=5789784;a.obj0Black=526344;a.obj1White=15921906;a.obj1LightGrey=10526880;a.obj1DarkGrey=5789784;a.obj1Black=526344;return a}(),Ba=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=5439232;a.bgDarkGrey=16728576;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=5439232;a.obj0DarkGrey=16728576;a.obj0Black=0;a.obj1White=16777215;
a.obj1LightGrey=5439232;a.obj1DarkGrey=16728576;a.obj1Black=0;return a}(),Ca=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=16711680;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16776960;a.obj0DarkGrey=16711680;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16776960;a.obj1DarkGrey=16711680;a.obj1Black=0;return a}(),Da=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16756067;a.bgDarkGrey=8663296;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16756067;
a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),Ea=function(){function a(){}a.bgWhite=0;a.bgLightGrey=33924;a.bgDarkGrey=16768512;a.bgBlack=16777215;a.obj0White=0;a.obj0LightGrey=33924;a.obj0DarkGrey=16768512;a.obj0Black=16777215;a.obj1White=0;a.obj1LightGrey=33924;a.obj1DarkGrey=16768512;a.obj1Black=16777215;return a}(),Fa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=10855845;a.bgDarkGrey=5395026;a.bgBlack=
0;a.obj0White=16777215;a.obj0LightGrey=10855845;a.obj0DarkGrey=5395026;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=10855845;a.obj1DarkGrey=5395026;a.obj1Black=0;return a}(),Ga=function(){function a(){}a.bgWhite=16777125;a.bgLightGrey=16749716;a.bgDarkGrey=9737471;a.bgBlack=0;a.obj0White=16777125;a.obj0LightGrey=16749716;a.obj0DarkGrey=9737471;a.obj0Black=0;a.obj1White=16777125;a.obj1LightGrey=16749716;a.obj1DarkGrey=9737471;a.obj1Black=0;return a}(),Ha=function(){function a(){}a.bgWhite=16770757;
a.bgLightGrey=13540484;a.bgDarkGrey=8678185;a.bgBlack=5910792;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),Ia=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=8126257;a.bgDarkGrey=25541;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=
0;return a}(),Ja=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=9211102;a.bgDarkGrey=5395084;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),Ka=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=
6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),La=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),Oa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=8079872;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=6530559;a.obj0DarkGrey=255;a.obj0Black=
0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),Pa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=10853631;a.obj0LightGrey=16776960;a.obj0DarkGrey=25344;a.obj0Black=0;a.obj1White=10853631;a.obj1LightGrey=16776960;a.obj1DarkGrey=25344;a.obj1Black=0;return a}(),Qa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=
16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),Ra=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),Sa=function(){function a(){}a.bgWhite=11908607;a.bgLightGrey=16777108;a.bgDarkGrey=11360834;
a.bgBlack=0;a.obj0White=0;a.obj0LightGrey=16777215;a.obj0DarkGrey=16745604;a.obj0Black=9714234;a.obj1White=0;a.obj1LightGrey=16777215;a.obj1DarkGrey=16745604;a.obj1Black=9714234;return a}(),Ta=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16741120;a.obj0DarkGrey=9716224;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=5946879;a.obj1DarkGrey=16711680;a.obj1Black=255;return a}(),Ua=function(){function a(){}
a.bgWhite=16777116;a.bgLightGrey=9745919;a.bgDarkGrey=6526067;a.bgBlack=14906;a.obj0White=16762178;a.obj0LightGrey=16766464;a.obj0DarkGrey=9714176;a.obj0Black=4849664;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),Va=function(){function a(){}a.bgWhite=7077632;a.bgLightGrey=16777215;a.bgDarkGrey=16732746;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16777215;a.obj0DarkGrey=6530559;a.obj0Black=255;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=
8663296;a.obj1Black=0;return a}(),Wa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=16737106;a.obj0LightGrey=14024704;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=255;a.obj1LightGrey=16777215;a.obj1DarkGrey=16777083;a.obj1Black=34047;return a}(),Xa=function(){function a(){}a.bgWhite=16777166;a.bgLightGrey=6549487;a.bgDarkGrey=10257457;a.bgBlack=5921370;a.obj0White=16777215;a.obj0LightGrey=16741120;a.obj0DarkGrey=9716224;a.obj0Black=
0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),Ya=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=65280;a.obj0DarkGrey=3245056;a.obj0Black=18944;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),Za=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=0;a.obj0White=16776960;a.obj0LightGrey=
16711680;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),$a=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=16756067;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),q=function(){function a(){}a.bgWhite=p.bgWhite;a.bgLightGrey=p.bgLightGrey;a.bgDarkGrey=
p.bgDarkGrey;a.bgBlack=p.bgBlack;a.obj0White=p.obj0White;a.obj0LightGrey=p.obj0LightGrey;a.obj0DarkGrey=p.obj0DarkGrey;a.obj0Black=p.obj0Black;a.obj1White=p.obj1White;a.obj1LightGrey=p.obj1LightGrey;a.obj1DarkGrey=p.obj1DarkGrey;a.obj1Black=p.obj1Black;return a}();
function ab(a){switch(a){case 0:q.bgWhite=p.bgWhite;q.bgLightGrey=p.bgLightGrey;q.bgDarkGrey=p.bgDarkGrey;q.bgBlack=p.bgBlack;q.obj0White=p.obj0White;q.obj0LightGrey=p.obj0LightGrey;q.obj0DarkGrey=p.obj0DarkGrey;q.obj0Black=p.obj0Black;q.obj1White=p.obj1White;q.obj1LightGrey=p.obj1LightGrey;q.obj1DarkGrey=p.obj1DarkGrey;q.obj1Black=p.obj1Black;break;case 1:q.bgWhite=Da.bgWhite;q.bgLightGrey=Da.bgLightGrey;q.bgDarkGrey=Da.bgDarkGrey;q.bgBlack=Da.bgBlack;q.obj0White=Da.obj0White;q.obj0LightGrey=Da.obj0LightGrey;
q.obj0DarkGrey=Da.obj0DarkGrey;q.obj0Black=Da.obj0Black;q.obj1White=Da.obj1White;q.obj1LightGrey=Da.obj1LightGrey;q.obj1DarkGrey=Da.obj1DarkGrey;q.obj1Black=Da.obj1Black;break;case 2:q.bgWhite=Ka.bgWhite;q.bgLightGrey=Ka.bgLightGrey;q.bgDarkGrey=Ka.bgDarkGrey;q.bgBlack=Ka.bgBlack;q.obj0White=Ka.obj0White;q.obj0LightGrey=Ka.obj0LightGrey;q.obj0DarkGrey=Ka.obj0DarkGrey;q.obj0Black=Ka.obj0Black;q.obj1White=Ka.obj1White;q.obj1LightGrey=Ka.obj1LightGrey;q.obj1DarkGrey=Ka.obj1DarkGrey;q.obj1Black=Ka.obj1Black;
break;case 3:q.bgWhite=Ha.bgWhite;q.bgLightGrey=Ha.bgLightGrey;q.bgDarkGrey=Ha.bgDarkGrey;q.bgBlack=Ha.bgBlack;q.obj0White=Ha.obj0White;q.obj0LightGrey=Ha.obj0LightGrey;q.obj0DarkGrey=Ha.obj0DarkGrey;q.obj0Black=Ha.obj0Black;q.obj1White=Ha.obj1White;q.obj1LightGrey=Ha.obj1LightGrey;q.obj1DarkGrey=Ha.obj1DarkGrey;q.obj1Black=Ha.obj1Black;break;case 4:q.bgWhite=Ba.bgWhite;q.bgLightGrey=Ba.bgLightGrey;q.bgDarkGrey=Ba.bgDarkGrey;q.bgBlack=Ba.bgBlack;q.obj0White=Ba.obj0White;q.obj0LightGrey=Ba.obj0LightGrey;
q.obj0DarkGrey=Ba.obj0DarkGrey;q.obj0Black=Ba.obj0Black;q.obj1White=Ba.obj1White;q.obj1LightGrey=Ba.obj1LightGrey;q.obj1DarkGrey=Ba.obj1DarkGrey;q.obj1Black=Ba.obj1Black;break;case 5:q.bgWhite=Ia.bgWhite;q.bgLightGrey=Ia.bgLightGrey;q.bgDarkGrey=Ia.bgDarkGrey;q.bgBlack=Ia.bgBlack;q.obj0White=Ia.obj0White;q.obj0LightGrey=Ia.obj0LightGrey;q.obj0DarkGrey=Ia.obj0DarkGrey;q.obj0Black=Ia.obj0Black;q.obj1White=Ia.obj1White;q.obj1LightGrey=Ia.obj1LightGrey;q.obj1DarkGrey=Ia.obj1DarkGrey;q.obj1Black=Ia.obj1Black;
break;case 6:q.bgWhite=Ea.bgWhite;q.bgLightGrey=Ea.bgLightGrey;q.bgDarkGrey=Ea.bgDarkGrey;q.bgBlack=Ea.bgBlack;q.obj0White=Ea.obj0White;q.obj0LightGrey=Ea.obj0LightGrey;q.obj0DarkGrey=Ea.obj0DarkGrey;q.obj0Black=Ea.obj0Black;q.obj1White=Ea.obj1White;q.obj1LightGrey=Ea.obj1LightGrey;q.obj1DarkGrey=Ea.obj1DarkGrey;q.obj1Black=Ea.obj1Black;break;case 7:q.bgWhite=Ga.bgWhite;q.bgLightGrey=Ga.bgLightGrey;q.bgDarkGrey=Ga.bgDarkGrey;q.bgBlack=Ga.bgBlack;q.obj0White=Ga.obj0White;q.obj0LightGrey=Ga.obj0LightGrey;
q.obj0DarkGrey=Ga.obj0DarkGrey;q.obj0Black=Ga.obj0Black;q.obj1White=Ga.obj1White;q.obj1LightGrey=Ga.obj1LightGrey;q.obj1DarkGrey=Ga.obj1DarkGrey;q.obj1Black=Ga.obj1Black;break;case 8:q.bgWhite=Ca.bgWhite;q.bgLightGrey=Ca.bgLightGrey;q.bgDarkGrey=Ca.bgDarkGrey;q.bgBlack=Ca.bgBlack;q.obj0White=Ca.obj0White;q.obj0LightGrey=Ca.obj0LightGrey;q.obj0DarkGrey=Ca.obj0DarkGrey;q.obj0Black=Ca.obj0Black;q.obj1White=Ca.obj1White;q.obj1LightGrey=Ca.obj1LightGrey;q.obj1DarkGrey=Ca.obj1DarkGrey;q.obj1Black=Ca.obj1Black;
break;case 9:q.bgWhite=Oa.bgWhite;q.bgLightGrey=Oa.bgLightGrey;q.bgDarkGrey=Oa.bgDarkGrey;q.bgBlack=Oa.bgBlack;q.obj0White=Oa.obj0White;q.obj0LightGrey=Oa.obj0LightGrey;q.obj0DarkGrey=Oa.obj0DarkGrey;q.obj0Black=Oa.obj0Black;q.obj1White=Oa.obj1White;q.obj1LightGrey=Oa.obj1LightGrey;q.obj1DarkGrey=Oa.obj1DarkGrey;q.obj1Black=Oa.obj1Black;break;case 10:q.bgWhite=La.bgWhite;q.bgLightGrey=La.bgLightGrey;q.bgDarkGrey=La.bgDarkGrey;q.bgBlack=La.bgBlack;q.obj0White=La.obj0White;q.obj0LightGrey=La.obj0LightGrey;
q.obj0DarkGrey=La.obj0DarkGrey;q.obj0Black=La.obj0Black;q.obj1White=La.obj1White;q.obj1LightGrey=La.obj1LightGrey;q.obj1DarkGrey=La.obj1DarkGrey;q.obj1Black=La.obj1Black;break;case 11:q.bgWhite=Ja.bgWhite;q.bgLightGrey=Ja.bgLightGrey;q.bgDarkGrey=Ja.bgDarkGrey;q.bgBlack=Ja.bgBlack;q.obj0White=Ja.obj0White;q.obj0LightGrey=Ja.obj0LightGrey;q.obj0DarkGrey=Ja.obj0DarkGrey;q.obj0Black=Ja.obj0Black;q.obj1White=Ja.obj1White;q.obj1LightGrey=Ja.obj1LightGrey;q.obj1DarkGrey=Ja.obj1DarkGrey;q.obj1Black=Ja.obj1Black;
break;case 12:q.bgWhite=Fa.bgWhite,q.bgLightGrey=Fa.bgLightGrey,q.bgDarkGrey=Fa.bgDarkGrey,q.bgBlack=Fa.bgBlack,q.obj0White=Fa.obj0White,q.obj0LightGrey=Fa.obj0LightGrey,q.obj0DarkGrey=Fa.obj0DarkGrey,q.obj0Black=Fa.obj0Black,q.obj1White=Fa.obj1White,q.obj1LightGrey=Fa.obj1LightGrey,q.obj1DarkGrey=Fa.obj1DarkGrey,q.obj1Black=Fa.obj1Black}}function r(a,b){return(a&255)<<8|b&255}function t(a){return(a&65280)>>8}function u(a,b){return b&~(1<<a)}function x(a,b){return 0!=(b&1<<a)}
var bb=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;return a}();
function cb(a,b){a=B(b)>>2*a&3;if(b===bb.memoryLocationSpritePaletteOne)switch(b=q.obj0White,a){case 1:b=q.obj0LightGrey;break;case 2:b=q.obj0DarkGrey;break;case 3:b=q.obj0Black}else if(b===bb.memoryLocationSpritePaletteTwo)switch(b=q.obj1White,a){case 1:b=q.obj1LightGrey;break;case 2:b=q.obj1DarkGrey;break;case 3:b=q.obj1Black}else switch(b=q.bgWhite,a){case 1:b=q.bgLightGrey;break;case 2:b=q.bgDarkGrey;break;case 3:b=q.bgBlack}return b}
function db(a,b,d){b=8*a+2*b;a=eb(b+1,d);d=eb(b,d);return r(a,d)}function fb(a,b){a*=5;return 8*((b&31<<a)>>a)}function eb(a,b){a&=63;b&&(a+=64);return c[ca+a]}function gb(a,b,d,g){void 0===d&&(d=0);void 0===g&&(g=!1);d&=3;g&&(d|=4);c[da+(160*b+a)]=d}var hb=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}();
function ib(a,b,d,g,h,w,A,z,v,y,J,C,K,X){var Ma=0;b=jb(b,a);a=kb(b+2*w,d);d=kb(b+2*w+1,d);for(w=g;w<=h;++w)if(b=A+(w-g),b<v){var R=w;if(0>K||!x(5,K))R=7-R;var L=0;x(R,d)&&(L+=1,L<<=1);x(R,a)&&(L+=1);if(f.GBCEnabled&&(0<=K||0<=X)){R=0<=X;var H=K&7;R&&(H=X&7);var Y=db(H,L,R);R=fb(0,Y);H=fb(1,Y);Y=fb(2,Y)}else if(0>=C&&(C=D.memoryLocationBackgroundPalette),J){H=L;Y=J;void 0===Y&&(Y=!1);R=H;Y||(R=B(C)>>(H<<1)&3);H=242;switch(R){case 1:H=160;break;case 2:H=88;break;case 3:H=8}H=R=Y=H}else Y=cb(L,C),R=
(Y&16711680)>>16,H=(Y&65280)>>8,Y&=255;var Na=3*(z*v+b);c[y+Na+0]=R;c[y+Na+1]=H;c[y+Na+2]=Y;R=!1;0<=K&&(R=x(7,K));gb(b,z,L,R);Ma++}return Ma}function jb(a,b){a===D.memoryLocationTileDataSelectZeroStart&&(b=x(7,b)?b-128:b+128);return a+16*b}function lb(a,b){switch(a){case 1:return x(b,129);case 2:return x(b,135);case 3:return x(b,126);default:return x(b,1)}}
var I=function(){function a(){}a.updateNRx0=function(b){var d=a.NRx0Negate;a.NRx0SweepPeriod=(b&112)>>4;a.NRx0Negate=x(3,b);a.NRx0SweepShift=b&7;d&&!a.NRx0Negate&&a.sweepNegateShouldDisableChannelOnClear&&(a.isEnabled=!1)};a.updateNRx1=function(b){a.NRx1Duty=b>>6&3;a.NRx1LengthLoad=b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=function(b){a.isEnabled&&(0===a.NRx2EnvelopePeriod&&a.isEnvelopeAutomaticUpdating&&(a.volume=a.volume+1&15),a.NRx2EnvelopeAddMode!==x(3,b)&&(a.volume=16-
a.volume&15));a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=x(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=!1)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var d=b&7;a.NRx4FrequencyMSB=d;a.frequency=d<<8|a.NRx3FrequencyLSB;d=1===(E.frameSequencer&1);var g=!a.NRx4LengthEnabled&&x(6,b);!d&&0<a.lengthCounter&&g&&(--a.lengthCounter,x(7,b)||0!==a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=x(6,b);
x(7,b)&&(a.trigger(),!d&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.cycleCounter;c[1028+50*a.saveStateSlot]=a.NRx0SweepPeriod;c[1029+50*a.saveStateSlot]=a.NRx0Negate;c[1030+50*a.saveStateSlot]=a.NRx0SweepShift;c[1031+50*a.saveStateSlot]=a.NRx1Duty;c[1033+50*a.saveStateSlot]=a.NRx1LengthLoad;c[1034+50*a.saveStateSlot]=a.NRx2StartingVolume;c[1035+50*a.saveStateSlot]=a.NRx2EnvelopeAddMode;c[1036+50*a.saveStateSlot]=a.NRx2EnvelopePeriod;
c[1037+50*a.saveStateSlot]=a.NRx3FrequencyLSB;c[1038+50*a.saveStateSlot]=a.NRx4LengthEnabled;c[1039+50*a.saveStateSlot]=a.NRx4FrequencyMSB;c[1040+50*a.saveStateSlot]=a.isEnabled;c[1041+50*a.saveStateSlot]=a.isDacEnabled;c[1042+50*a.saveStateSlot]=a.frequency;c[1046+50*a.saveStateSlot]=a.frequencyTimer;c[1050+50*a.saveStateSlot]=a.envelopeCounter;c[1054+50*a.saveStateSlot]=a.isEnvelopeAutomaticUpdating;c[1055+50*a.saveStateSlot]=a.lengthCounter;c[1059+50*a.saveStateSlot]=a.volume;c[1063+50*a.saveStateSlot]=
a.dutyCycle;c[1064+50*a.saveStateSlot]=a.waveFormPositionOnDuty;c[1065+50*a.saveStateSlot]=a.isSweepEnabled;c[1066+50*a.saveStateSlot]=a.sweepCounter;c[1070+50*a.saveStateSlot]=a.sweepShadowFrequency;c[1073+50*a.saveStateSlot]=a.sweepNegateShouldDisableChannelOnClear};a.loadState=function(){a.cycleCounter=c[1024+50*a.cycleCounter];a.NRx0SweepPeriod=c[1028+50*a.saveStateSlot];a.NRx0Negate=F(1029+50*a.saveStateSlot);a.NRx0SweepShift=c[1030+50*a.saveStateSlot];a.NRx1Duty=c[1031+50*a.saveStateSlot];a.NRx1LengthLoad=
c[1033+50*a.saveStateSlot];a.NRx2StartingVolume=c[1034+50*a.saveStateSlot];a.NRx2EnvelopeAddMode=F(1035+50*a.saveStateSlot);a.NRx2EnvelopePeriod=c[1036+50*a.saveStateSlot];a.NRx3FrequencyLSB=c[1037+50*a.saveStateSlot];a.NRx4LengthEnabled=F(1038+50*a.saveStateSlot);a.NRx4FrequencyMSB=c[1039+50*a.saveStateSlot];a.isEnabled=F(1040+50*a.saveStateSlot);a.isDacEnabled=F(1041+50*a.saveStateSlot);a.frequency=c[1042+50*a.saveStateSlot];a.frequencyTimer=c[1046+50*a.saveStateSlot];a.envelopeCounter=c[1050+50*
a.saveStateSlot];a.isEnvelopeAutomaticUpdating=F(1054+50*a.saveStateSlot);a.lengthCounter=c[1055+50*a.saveStateSlot];a.volume=c[1059+50*a.saveStateSlot];a.dutyCycle=c[1063+50*a.saveStateSlot];a.waveFormPositionOnDuty=c[1064+50*a.saveStateSlot];a.isSweepEnabled=F(1065+50*a.saveStateSlot);a.sweepCounter=c[1066+50*a.saveStateSlot];a.sweepShadowFrequency=c[1070+50*a.saveStateSlot];a.sweepNegateShouldDisableChannelOnClear=F(1073+50*a.saveStateSlot)};a.initialize=function(){G(a.memoryLocationNRx0,128);
G(a.memoryLocationNRx1,191);G(a.memoryLocationNRx2,243);G(a.memoryLocationNRx3,193);G(a.memoryLocationNRx4,191);f.BootROMEnabled&&(G(a.memoryLocationNRx1,63),G(a.memoryLocationNRx2,0),G(a.memoryLocationNRx3,0),G(a.memoryLocationNRx4,184))};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){var b=2048-a.frequency<<2;f.GBCDoubleSpeed&&(b<<=2);a.frequencyTimer=b};a.getSample=function(b){var d=a.frequencyTimer;for(d-=b;0>=d;)b=Math.abs(d),
a.resetTimer(),d=a.frequencyTimer,d-=b,a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7;a.frequencyTimer=d;if(a.isEnabled&&a.isDacEnabled)d=a.volume&15;else return 15;b=1;lb(a.NRx1Duty,a.waveFormPositionOnDuty)||(b=-b);return b*d+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.envelopeCounter=0===a.NRx2EnvelopePeriod?8:a.NRx2EnvelopePeriod;a.isEnvelopeAutomaticUpdating=!0;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;
a.sweepCounter=0===a.NRx0SweepPeriod?8:a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod||0<a.NRx0SweepShift;a.sweepNegateShouldDisableChannelOnClear=!1;var b;if(b=0<a.NRx0SweepShift)b=2047<mb()?!0:!1;b&&(a.isEnabled=!1);a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateSweep=function(){if(a.isEnabled&&a.isSweepEnabled){var b=a.sweepCounter-1;0>=b?0===a.NRx0SweepPeriod?a.sweepCounter=8:(a.sweepCounter=
a.NRx0SweepPeriod,b=mb(),2047<b&&(a.isEnabled=!1),0<a.NRx0SweepShift&&(a.setFrequency(b),2047<mb()&&(a.isEnabled=!1))):a.sweepCounter=b}};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&(--b,0===b&&(a.isEnabled=!1));a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b)if(0===a.NRx2EnvelopePeriod)b=8;else if(b=a.NRx2EnvelopePeriod,0!==b&&a.isEnvelopeAutomaticUpdating){var d=a.volume;d=a.NRx2EnvelopeAddMode?d+1:d-1;d&=15;15>d?a.volume=d:a.isEnvelopeAutomaticUpdating=
!1}a.envelopeCounter=b};a.setFrequency=function(b){a.sweepShadowFrequency=b;var d=b>>8&7;b&=255;var g=B(a.memoryLocationNRx4)&248|d;G(a.memoryLocationNRx3,b);G(a.memoryLocationNRx4,g);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=
0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.isEnvelopeAutomaticUpdating=!1;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.sweepNegateShouldDisableChannelOnClear=!1;a.saveStateSlot=7;return a}();
function mb(){var a=I.sweepShadowFrequency,b=a>>I.NRx0SweepShift;I.NRx0Negate?(I.sweepNegateShouldDisableChannelOnClear=!0,b=a-b):b=a+b;return b}
var M=function(){function a(){}a.updateNRx1=function(b){a.NRx1Duty=b>>6&3;a.NRx1LengthLoad=b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=function(b){a.isEnabled&&(0===a.NRx2EnvelopePeriod&&a.isEnvelopeAutomaticUpdating&&(a.volume=a.volume+1&15),a.NRx2EnvelopeAddMode!==x(3,b)&&(a.volume=16-a.volume&15));a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=x(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;
a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var d=b&7;a.NRx4FrequencyMSB=d;a.frequency=d<<8|a.NRx3FrequencyLSB;d=1===(E.frameSequencer&1);var g=!a.NRx4LengthEnabled&&x(6,b);!d&&0<a.lengthCounter&&g&&(--a.lengthCounter,x(7,b)||0!==a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=x(6,b);x(7,b)&&(a.trigger(),!d&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.cycleCounter;c[1031+50*a.saveStateSlot]=a.NRx1Duty;
c[1032+50*a.saveStateSlot]=a.NRx1LengthLoad;c[1034+50*a.saveStateSlot]=a.NRx2StartingVolume;c[1035+50*a.saveStateSlot]=a.NRx2EnvelopeAddMode;c[1036+50*a.saveStateSlot]=a.NRx2EnvelopePeriod;c[1037+50*a.saveStateSlot]=a.NRx3FrequencyLSB;c[1038+50*a.saveStateSlot]=a.NRx4LengthEnabled;c[1039+50*a.saveStateSlot]=a.NRx4FrequencyMSB;c[1040+50*a.saveStateSlot]=a.isEnabled;c[1041+50*a.saveStateSlot]=a.isDacEnabled;c[1042+50*a.saveStateSlot]=a.frequency;c[1046+50*a.saveStateSlot]=a.frequencyTimer;c[1050+50*
a.saveStateSlot]=a.envelopeCounter;c[1054+50*a.saveStateSlot]=a.isEnvelopeAutomaticUpdating;c[1055+50*a.saveStateSlot]=a.lengthCounter;c[1059+50*a.saveStateSlot]=a.volume;c[1063+50*a.saveStateSlot]=a.dutyCycle;c[1064+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=function(){a.cycleCounter=c[1024+50*a.cycleCounter];a.NRx1Duty=c[1031+50*a.saveStateSlot];a.NRx1LengthLoad=c[1032+50*a.saveStateSlot];a.NRx2StartingVolume=c[1034+50*a.saveStateSlot];a.NRx2EnvelopeAddMode=F(1035+50*a.saveStateSlot);
a.NRx2EnvelopePeriod=c[1036+50*a.saveStateSlot];a.NRx3FrequencyLSB=c[1037+50*a.saveStateSlot];a.NRx4LengthEnabled=F(1038+50*a.saveStateSlot);a.NRx4FrequencyMSB=c[1039+50*a.saveStateSlot];a.isEnabled=F(1040+50*a.saveStateSlot);a.isDacEnabled=F(1041+50*a.saveStateSlot);a.frequency=c[1042+50*a.saveStateSlot];a.frequencyTimer=c[1046+50*a.saveStateSlot];a.envelopeCounter=c[1050+50*a.saveStateSlot];a.isEnvelopeAutomaticUpdating=F(1054+50*a.saveStateSlot);a.lengthCounter=c[1055+50*a.saveStateSlot];a.volume=
c[1059+50*a.saveStateSlot];a.dutyCycle=c[1063+50*a.saveStateSlot];a.waveFormPositionOnDuty=c[1064+50*a.saveStateSlot]};a.initialize=function(){G(a.memoryLocationNRx1-1,255);G(a.memoryLocationNRx1,63);G(a.memoryLocationNRx2,0);G(a.memoryLocationNRx3,0);G(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<2<<f.GBCDoubleSpeed};a.getSample=function(b){var d=a.frequencyTimer;
for(d-=b;0>=d;)b=Math.abs(d),a.resetTimer(),d=a.frequencyTimer,d-=b,a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7;a.frequencyTimer=d;if(a.isEnabled&&a.isDacEnabled)d=a.volume&15;else return 15;b=1;lb(a.NRx1Duty,a.waveFormPositionOnDuty)||(b=-b);return b*d+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.envelopeCounter=0===a.NRx2EnvelopePeriod?8:a.NRx2EnvelopePeriod;a.isEnvelopeAutomaticUpdating=!0;a.volume=a.NRx2StartingVolume;a.isDacEnabled||
(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b)if(0===a.NRx2EnvelopePeriod)b=8;else if(b=a.NRx2EnvelopePeriod,0!==b&&a.isEnvelopeAutomaticUpdating){var d=a.volume;d=a.NRx2EnvelopeAddMode?d+1:d-1;d&=15;15>d?a.volume=d:a.isEnvelopeAutomaticUpdating=!1}a.envelopeCounter=
b};a.setFrequency=function(b){var d=b>>8;b&=255;var g=B(a.memoryLocationNRx4)&248|d;G(a.memoryLocationNRx3,b);G(a.memoryLocationNRx4,g);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=d;a.frequency=d<<8|b};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65301;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=
!1;a.NRx4FrequencyMSB=0;a.channelNumber=2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.isEnvelopeAutomaticUpdating=!1;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),N=function(){function a(){}a.updateNRx0=function(b){b=x(7,b);!a.isDacEnabled&&b&&(a.sampleBuffer=0);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx1=function(b){a.NRx1LengthLoad=b;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=
function(b){a.NRx2VolumeCode=b>>5&15};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var d=b&7;a.NRx4FrequencyMSB=d;a.frequency=d<<8|a.NRx3FrequencyLSB;d=1===(E.frameSequencer&1);if(!d){var g=!a.NRx4LengthEnabled&&x(6,b);0<a.lengthCounter&&g&&(--a.lengthCounter,x(7,b)||0!==a.lengthCounter||(a.isEnabled=!1))}a.NRx4LengthEnabled=x(6,b);x(7,b)&&(a.trigger(),!d&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=
function(){c[1024+50*a.saveStateSlot]=a.cycleCounter;c[1032+50*a.saveStateSlot]=a.NRx1LengthLoad;c[1034+50*a.saveStateSlot]=a.NRx2VolumeCode;c[1036+50*a.saveStateSlot]=a.NRx3FrequencyLSB;c[1037+50*a.saveStateSlot]=a.NRx4LengthEnabled;c[1038+50*a.saveStateSlot]=a.NRx4FrequencyMSB;c[1039+50*a.saveStateSlot]=a.isEnabled;c[1040+50*a.saveStateSlot]=a.isDacEnabled;c[1041+50*a.saveStateSlot]=a.frequency;c[1045+50*a.saveStateSlot]=a.frequencyTimer;c[1049+50*a.saveStateSlot]=a.lengthCounter;c[1057+50*a.saveStateSlot]=
a.waveTablePosition;c[1061+50*a.saveStateSlot]=a.volumeCode;c[1062+50*a.saveStateSlot]=a.volumeCodeChanged;c[1063+50*a.saveStateSlot]=a.sampleBuffer};a.loadState=function(){a.cycleCounter=c[1024+50*a.cycleCounter];a.NRx1LengthLoad=c[1032+50*a.saveStateSlot];a.NRx2VolumeCode=c[1034+50*a.saveStateSlot];a.NRx3FrequencyLSB=c[1036+50*a.saveStateSlot];a.NRx4LengthEnabled=F(1037+50*a.saveStateSlot);a.NRx4FrequencyMSB=c[1038+50*a.saveStateSlot];a.isEnabled=F(1039+50*a.saveStateSlot);a.isDacEnabled=F(1040+
50*a.saveStateSlot);a.frequency=c[1041+50*a.saveStateSlot];a.frequencyTimer=c[1045+50*a.saveStateSlot];a.lengthCounter=c[1049+50*a.saveStateSlot];a.waveTablePosition=c[1057+50*a.saveStateSlot];a.volumeCode=c[1061+50*a.saveStateSlot];a.volumeCodeChanged=F(1062+50*a.saveStateSlot);a.sampleBuffer=c[1063+50*a.saveStateSlot]};a.handleWaveRamRead=function(){return B(N.memoryLocationWaveTable+(N.waveTablePosition>>1|0))};a.handleWaveRamWrite=function(b){G(a.memoryLocationWaveTable+(a.waveTablePosition>>
1|0),b)};a.initialize=function(){G(a.memoryLocationNRx0,127);G(a.memoryLocationNRx1,255);G(a.memoryLocationNRx2,159);G(a.memoryLocationNRx3,0);G(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<1<<f.GBCDoubleSpeed};a.getSample=function(b){if(!a.isEnabled||!a.isDacEnabled)return 15;var d=a.volumeCode;a.volumeCodeChanged&&(d=B(a.memoryLocationNRx2),
d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);var g=N.sampleBuffer;g>>=(0===(N.waveTablePosition&1))<<2;g&=15;var h=0;switch(d){case 0:g>>=4;break;case 1:h=1;break;case 2:g>>=1;h=2;break;default:g>>=2,h=4}g=(0<h?g/h:0)+15;d=a.frequencyTimer;for(d-=b;0>=d;){b=Math.abs(d);a.resetTimer();d=a.frequencyTimer;d-=b;b=N.waveTablePosition;for(b+=1;32<=b;)b-=32;N.waveTablePosition=b;N.sampleBuffer=B(N.memoryLocationWaveTable+(N.waveTablePosition>>1|0))}a.frequencyTimer=d;return g};a.trigger=function(){a.isEnabled=
!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.frequencyTimer+=6;a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(!a.volumeCodeChanged&&0<a.frequencyTimer-a.cycleCounter)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.cycleCounter=0;a.MAX_LENGTH=256;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=
65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.sampleBuffer=0;a.saveStateSlot=9;return a}(),O=function(){function a(){}a.updateNRx1=function(b){a.NRx1LengthLoad=b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};
a.updateNRx2=function(b){a.isEnabled&&(0===a.NRx2EnvelopePeriod&&a.isEnvelopeAutomaticUpdating&&(a.volume=a.volume+1&15),a.NRx2EnvelopeAddMode!==x(3,b)&&(a.volume=16-a.volume&15));a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=x(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx3=function(b){var d=b&7;a.NRx3ClockShift=b>>4;a.NRx3WidthMode=x(3,b);a.NRx3DivisorCode=d;d<<=1;1>d&&(d=1);a.divisor=d<<3};a.updateNRx4=function(b){var d=1===(E.frameSequencer&1),
g=!a.NRx4LengthEnabled&&x(6,b);!d&&0<a.lengthCounter&&g&&(--a.lengthCounter,x(7,b)||0!==a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=x(6,b);x(7,b)&&(a.trigger(),!d&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.cycleCounter;c[1028+50*a.saveStateSlot]=a.NRx1LengthLoad;c[1030+50*a.saveStateSlot]=a.NRx2StartingVolume;c[1031+50*a.saveStateSlot]=a.NRx2EnvelopeAddMode;c[1032+50*a.saveStateSlot]=a.NRx2EnvelopePeriod;
c[1033+50*a.saveStateSlot]=a.NRx3ClockShift;c[1034+50*a.saveStateSlot]=a.NRx3WidthMode;c[1035+50*a.saveStateSlot]=a.NRx3DivisorCode;c[1037+50*a.saveStateSlot]=a.NRx4LengthEnabled;c[1039+50*a.saveStateSlot]=a.isEnabled;c[1040+50*a.saveStateSlot]=a.isDacEnabled;c[1045+50*a.saveStateSlot]=a.frequencyTimer;c[1049+50*a.saveStateSlot]=a.envelopeCounter;c[1053+50*a.saveStateSlot]=a.isEnvelopeAutomaticUpdating;c[1054+50*a.saveStateSlot]=a.lengthCounter;c[1058+50*a.saveStateSlot]=a.volume;c[1062+50*a.saveStateSlot]=
a.linearFeedbackShiftRegister};a.loadState=function(){a.cycleCounter=c[1024+50*a.cycleCounter];a.NRx1LengthLoad=c[1028+50*a.saveStateSlot];a.NRx2StartingVolume=c[1030+50*a.saveStateSlot];a.NRx2EnvelopeAddMode=F(1031+50*a.saveStateSlot);a.NRx2EnvelopePeriod=c[1032+50*a.saveStateSlot];a.NRx3ClockShift=c[1033+50*a.saveStateSlot];a.NRx3WidthMode=F(1034+50*a.saveStateSlot);a.NRx3DivisorCode=c[1035+50*a.saveStateSlot];a.NRx4LengthEnabled=F(1037+50*a.saveStateSlot);a.isEnabled=F(1039+50*a.saveStateSlot);
a.isDacEnabled=F(1040+50*a.saveStateSlot);a.frequencyTimer=c[1045+50*a.saveStateSlot];a.envelopeCounter=c[1049+50*a.saveStateSlot];a.isEnvelopeAutomaticUpdating=F(1053+50*a.saveStateSlot);a.lengthCounter=c[1054+50*a.saveStateSlot];a.volume=c[1058+50*a.saveStateSlot];a.linearFeedbackShiftRegister=c[1062+50*a.saveStateSlot]};a.initialize=function(){G(a.memoryLocationNRx1-1,255);G(a.memoryLocationNRx1,255);G(a.memoryLocationNRx2,0);G(a.memoryLocationNRx3,0);G(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=
function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.getSample=function(b){var d=a.frequencyTimer;d-=b;if(0>=d){b=Math.abs(d);d=a.getNoiseChannelFrequencyPeriod();d-=b;b=a.linearFeedbackShiftRegister;var g=b&1^b>>1&1;b=b>>1|g<<14;a.NRx3WidthMode&&(b=b&-65|g<<6);a.linearFeedbackShiftRegister=b}0>d&&(d=0);a.frequencyTimer=d;if(a.isEnabled&&a.isDacEnabled)d=a.volume&15;else return 15;b=x(0,a.linearFeedbackShiftRegister)?-1:1;return b*d+15};a.trigger=function(){a.isEnabled=!0;0===
a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();a.envelopeCounter=0===a.NRx2EnvelopePeriod?8:a.NRx2EnvelopePeriod;a.isEnvelopeAutomaticUpdating=!0;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(0<a.frequencyTimer-a.cycleCounter)};a.getNoiseChannelFrequencyPeriod=function(){return a.divisor<<a.NRx3ClockShift<<f.GBCDoubleSpeed};a.updateLength=
function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b)if(0===a.NRx2EnvelopePeriod)b=8;else if(b=a.NRx2EnvelopePeriod,0!==b&&a.isEnvelopeAutomaticUpdating){var d=a.volume;d=a.NRx2EnvelopeAddMode?d+1:d-1;d&=15;15>d?a.volume=d:a.isEnvelopeAutomaticUpdating=!1}a.envelopeCounter=b};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65311;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=
65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.isEnvelopeAutomaticUpdating=!1;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=10;return a}(),P=function(){function a(){}a.channel1Sample=15;a.channel2Sample=
15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}();
function nb(a){switch(a){case I.channelNumber:a=I.isDacEnabled;var b=P.channel1DacEnabled!==a;P.channel1DacEnabled=a;return b;case M.channelNumber:return a=M.isDacEnabled,b=P.channel2DacEnabled!==a,P.channel2DacEnabled=a,b;case N.channelNumber:return a=N.isDacEnabled,b=P.channel3DacEnabled!==a,P.channel3DacEnabled=a,b;case O.channelNumber:return a=O.isDacEnabled,b=P.channel4DacEnabled!==a,P.channel4DacEnabled=a,b}return!1}
var E=function(){function a(){}a.batchProcessCycles=function(){return 87<<f.GBCDoubleSpeed};a.updateNR50=function(b){a.NR50LeftMixerVolume=b>>4&7;a.NR50RightMixerVolume=b&7};a.updateNR51=function(b){a.NR51IsChannel4EnabledOnLeftOutput=x(7,b);a.NR51IsChannel3EnabledOnLeftOutput=x(6,b);a.NR51IsChannel2EnabledOnLeftOutput=x(5,b);a.NR51IsChannel1EnabledOnLeftOutput=x(4,b);a.NR51IsChannel4EnabledOnRightOutput=x(3,b);a.NR51IsChannel3EnabledOnRightOutput=x(2,b);a.NR51IsChannel2EnabledOnRightOutput=x(1,b);
a.NR51IsChannel1EnabledOnRightOutput=x(0,b)};a.updateNR52=function(b){a.NR52IsSoundEnabled=x(7,b)};a.maxFrameSequenceCycles=function(){return 8192<<f.GBCDoubleSpeed};a.maxDownSampleCycles=function(){return f.CLOCK_SPEED()/a.sampleRate};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.NR50LeftMixerVolume;c[1028+50*a.saveStateSlot]=a.NR50RightMixerVolume;c[1032+50*a.saveStateSlot]=a.NR51IsChannel1EnabledOnLeftOutput;c[1033+50*a.saveStateSlot]=a.NR51IsChannel2EnabledOnLeftOutput;c[1034+50*a.saveStateSlot]=
a.NR51IsChannel3EnabledOnLeftOutput;c[1035+50*a.saveStateSlot]=a.NR51IsChannel4EnabledOnLeftOutput;c[1036+50*a.saveStateSlot]=a.NR51IsChannel1EnabledOnRightOutput;c[1037+50*a.saveStateSlot]=a.NR51IsChannel2EnabledOnRightOutput;c[1038+50*a.saveStateSlot]=a.NR51IsChannel3EnabledOnRightOutput;c[1039+50*a.saveStateSlot]=a.NR51IsChannel4EnabledOnRightOutput;c[1040+50*a.saveStateSlot]=a.NR52IsSoundEnabled;c[1041+50*a.saveStateSlot]=a.frameSequenceCycleCounter;c[1046+50*a.saveStateSlot]=a.frameSequencer;
c[1047+50*a.saveStateSlot]=a.downSampleCycleCounter;c[1048+50*a.saveStateSlot]=P.channel1Sample;c[1049+50*a.saveStateSlot]=P.channel2Sample;c[1050+50*a.saveStateSlot]=P.channel3Sample;c[1051+50*a.saveStateSlot]=P.channel4Sample;c[1052+50*a.saveStateSlot]=P.channel1DacEnabled;c[1053+50*a.saveStateSlot]=P.channel2DacEnabled;c[1054+50*a.saveStateSlot]=P.channel3DacEnabled;c[1055+50*a.saveStateSlot]=P.channel4DacEnabled;c[1056+50*a.saveStateSlot]=P.leftChannelSampleUnsignedByte;c[1057+50*a.saveStateSlot]=
P.rightChannelSampleUnsignedByte;c[1058+50*a.saveStateSlot]=P.mixerVolumeChanged;c[1059+50*a.saveStateSlot]=P.mixerEnabledChanged};a.loadState=function(){a.NR50LeftMixerVolume=c[1024+50*a.saveStateSlot];a.NR50RightMixerVolume=c[1028+50*a.saveStateSlot];a.NR51IsChannel1EnabledOnLeftOutput=F(1032+50*a.saveStateSlot);a.NR51IsChannel2EnabledOnLeftOutput=F(1033+50*a.saveStateSlot);a.NR51IsChannel3EnabledOnLeftOutput=F(1034+50*a.saveStateSlot);a.NR51IsChannel4EnabledOnLeftOutput=F(1035+50*a.saveStateSlot);
a.NR51IsChannel1EnabledOnRightOutput=F(1036+50*a.saveStateSlot);a.NR51IsChannel2EnabledOnRightOutput=F(1037+50*a.saveStateSlot);a.NR51IsChannel3EnabledOnRightOutput=F(1038+50*a.saveStateSlot);a.NR51IsChannel4EnabledOnRightOutput=F(1039+50*a.saveStateSlot);a.NR52IsSoundEnabled=F(1040+50*a.saveStateSlot);a.frameSequenceCycleCounter=c[1041+50*a.saveStateSlot];a.frameSequencer=c[1046+50*a.saveStateSlot];a.downSampleCycleCounter=c[1047+50*a.saveStateSlot];P.channel1Sample=c[1048+50*a.saveStateSlot];P.channel2Sample=
c[1049+50*a.saveStateSlot];P.channel3Sample=c[1050+50*a.saveStateSlot];P.channel4Sample=c[1051+50*a.saveStateSlot];P.channel1DacEnabled=F(1052+50*a.saveStateSlot);P.channel2DacEnabled=F(1053+50*a.saveStateSlot);P.channel3DacEnabled=F(1054+50*a.saveStateSlot);P.channel4DacEnabled=F(1055+50*a.saveStateSlot);P.leftChannelSampleUnsignedByte=c[1056+50*a.saveStateSlot];P.rightChannelSampleUnsignedByte=c[1057+50*a.saveStateSlot];P.mixerVolumeChanged=F(1058+50*a.saveStateSlot);P.mixerEnabledChanged=F(1059+
50*a.saveStateSlot);ob()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=
!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.frameSequencer=0;a.downSampleCycleCounter=0;a.sampleRate=44100;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}();function pb(){for(var a=E.batchProcessCycles(),b=E.currentCycles;b>=a;)qb(a),b-=a;E.currentCycles=b}
function qb(a){var b=E.maxFrameSequenceCycles();var d=E.frameSequenceCycleCounter+a;if(d>=b){E.frameSequenceCycleCounter=d-b;b=E.frameSequencer+1&7;switch(b){case 0:I.updateLength();M.updateLength();N.updateLength();O.updateLength();break;case 2:I.updateLength();M.updateLength();N.updateLength();O.updateLength();I.updateSweep();break;case 4:I.updateLength();M.updateLength();N.updateLength();O.updateLength();break;case 6:I.updateLength();M.updateLength();N.updateLength();O.updateLength();I.updateSweep();
break;case 7:I.updateEnvelope(),M.updateEnvelope(),O.updateEnvelope()}E.frameSequencer=b;b=!0}else E.frameSequenceCycleCounter=d,b=!1;if(e.audioAccumulateSamples&&!b){b=I.willChannelUpdate(a)||nb(I.channelNumber);d=M.willChannelUpdate(a)||nb(M.channelNumber);var g=N.willChannelUpdate(a)||nb(N.channelNumber),h=O.willChannelUpdate(a)||nb(O.channelNumber);b&&(P.channel1Sample=I.getSampleFromCycleCounter());d&&(P.channel2Sample=M.getSampleFromCycleCounter());g&&(P.channel3Sample=N.getSampleFromCycleCounter());
h&&(P.channel4Sample=O.getSampleFromCycleCounter());if(b||d||g||h)P.needToRemixSamples=!0;b=E.downSampleCycleCounter;b+=a;a=E.maxDownSampleCycles();b>=a&&(b-=a,P.needToRemixSamples||P.mixerVolumeChanged||P.mixerEnabledChanged?rb(P.channel1Sample,P.channel2Sample,P.channel3Sample,P.channel4Sample):E.downSampleCycleCounter=b,sb(P.leftChannelSampleUnsignedByte+1,P.rightChannelSampleUnsignedByte+1,oa),a=E.audioQueueIndex+1,a>=(E.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--a,E.audioQueueIndex=a);E.downSampleCycleCounter=
b}else{b=I.getSample(a)|0;d=M.getSample(a)|0;g=N.getSample(a)|0;h=O.getSample(a)|0;P.channel1Sample=b;P.channel2Sample=d;P.channel3Sample=g;P.channel4Sample=h;a=E.downSampleCycleCounter+a;if(a>=E.maxDownSampleCycles()){a-=E.maxDownSampleCycles();var w=rb(b,d,g,h),A=t(w);sb(A+1,(w&255)+1,oa);e.enableAudioDebugging&&(w=rb(b,15,15,15),A=t(w),sb(A+1,(w&255)+1,ka),w=rb(15,d,15,15),A=t(w),sb(A+1,(w&255)+1,la),w=rb(15,15,g,15),A=t(w),sb(A+1,(w&255)+1,ma),w=rb(15,15,15,h),A=t(w),sb(A+1,(w&255)+1,na));b=E.audioQueueIndex+
1;b>=(E.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--b;E.audioQueueIndex=b}E.downSampleCycleCounter=a}}function tb(){return E.audioQueueIndex}function ob(){E.audioQueueIndex=0}
function rb(a,b,d,g){void 0===a&&(a=15);void 0===b&&(b=15);void 0===d&&(d=15);void 0===g&&(g=15);P.mixerVolumeChanged=!1;var h=0+(E.NR51IsChannel1EnabledOnLeftOutput?a:15);h+=E.NR51IsChannel2EnabledOnLeftOutput?b:15;h+=E.NR51IsChannel3EnabledOnLeftOutput?d:15;h+=E.NR51IsChannel4EnabledOnLeftOutput?g:15;a=0+(E.NR51IsChannel1EnabledOnRightOutput?a:15);a+=E.NR51IsChannel2EnabledOnRightOutput?b:15;a+=E.NR51IsChannel3EnabledOnRightOutput?d:15;a+=E.NR51IsChannel4EnabledOnRightOutput?g:15;P.mixerEnabledChanged=
!1;P.needToRemixSamples=!1;b=ub(h,E.NR50LeftMixerVolume+1);d=ub(a,E.NR50RightMixerVolume+1);P.leftChannelSampleUnsignedByte=b;P.rightChannelSampleUnsignedByte=d;return r(b,d)}function ub(a,b){if(60===a)return 127;a=1E5*(a-60)*b>>3;a=(a/1E5|0)+60;a=1E5*a/(12E6/254|0)|0;return a|=0}function sb(a,b,d){d+=E.audioQueueIndex<<1;c[d+0]=a+1;c[d+1]=b+1}
function vb(a){switch(a){case I.memoryLocationNRx0:return a=B(I.memoryLocationNRx0),a|128;case M.memoryLocationNRx0:return a=B(M.memoryLocationNRx0),a|255;case N.memoryLocationNRx0:return a=B(N.memoryLocationNRx0),a|127;case O.memoryLocationNRx0:return a=B(O.memoryLocationNRx0),a|255;case E.memoryLocationNR50:return a=B(E.memoryLocationNR50),a|0;case I.memoryLocationNRx1:return a=B(I.memoryLocationNRx1),a|63;case M.memoryLocationNRx1:return a=B(M.memoryLocationNRx1),a|63;case N.memoryLocationNRx1:return a=
B(N.memoryLocationNRx1),a|255;case O.memoryLocationNRx1:return a=B(O.memoryLocationNRx1),a|255;case E.memoryLocationNR51:return a=B(E.memoryLocationNR51),a|0;case I.memoryLocationNRx2:return a=B(I.memoryLocationNRx2),a|0;case M.memoryLocationNRx2:return a=B(M.memoryLocationNRx2),a|0;case N.memoryLocationNRx2:return a=B(N.memoryLocationNRx2),a|159;case O.memoryLocationNRx2:return a=B(O.memoryLocationNRx2),a|0;case E.memoryLocationNR52:return a=0,a=E.NR52IsSoundEnabled?a|128:u(7,a),a=I.isEnabled?a|
1:u(0,a),a=M.isEnabled?a|2:u(1,a),a=N.isEnabled?a|4:u(2,a),a=O.isEnabled?a|8:u(3,a),a|112;case I.memoryLocationNRx3:return a=B(I.memoryLocationNRx3),a|255;case M.memoryLocationNRx3:return a=B(M.memoryLocationNRx3),a|255;case N.memoryLocationNRx3:return a=B(N.memoryLocationNRx3),a|255;case O.memoryLocationNRx3:return a=B(O.memoryLocationNRx3),a|0;case I.memoryLocationNRx4:return a=B(I.memoryLocationNRx4),a|191;case M.memoryLocationNRx4:return a=B(M.memoryLocationNRx4),a|191;case N.memoryLocationNRx4:return a=
B(N.memoryLocationNRx4),a|191;case O.memoryLocationNRx4:return a=B(O.memoryLocationNRx4),a|191}return-1}
var Q=function(){function a(){}a.updateInterruptEnabled=function(b){a.isVBlankInterruptEnabled=x(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptEnabled=x(a.bitPositionLcdInterrupt,b);a.isTimerInterruptEnabled=x(a.bitPositionTimerInterrupt,b);a.isSerialInterruptEnabled=x(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptEnabled=x(a.bitPositionJoypadInterrupt,b);a.interruptsEnabledValue=b};a.updateInterruptRequested=function(b){a.isVBlankInterruptRequested=x(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptRequested=
x(a.bitPositionLcdInterrupt,b);a.isTimerInterruptRequested=x(a.bitPositionTimerInterrupt,b);a.isSerialInterruptRequested=x(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptRequested=x(a.bitPositionJoypadInterrupt,b);a.interruptsRequestedValue=b};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.masterInterruptSwitch;c[1025+50*a.saveStateSlot]=a.masterInterruptSwitchDelay;c[1040+50*a.saveStateSlot]=
a.interruptsEnabledValue;c[1041+50*a.saveStateSlot]=a.isVBlankInterruptEnabled;c[1042+50*a.saveStateSlot]=a.isLcdInterruptEnabled;c[1043+50*a.saveStateSlot]=a.isTimerInterruptEnabled;c[1044+50*a.saveStateSlot]=a.isSerialInterruptEnabled;c[1045+50*a.saveStateSlot]=a.isJoypadInterruptEnabled;c[1056+50*a.saveStateSlot]=a.interruptsRequestedValue;c[1057+50*a.saveStateSlot]=a.isVBlankInterruptRequested;c[1058+50*a.saveStateSlot]=a.isLcdInterruptRequested;c[1059+50*a.saveStateSlot]=a.isTimerInterruptRequested;
c[1060+50*a.saveStateSlot]=a.isSerialInterruptRequested;c[1061+50*a.saveStateSlot]=a.isJoypadInterruptRequested};a.loadState=function(){a.masterInterruptSwitch=F(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=F(1025+50*a.saveStateSlot);a.interruptsEnabledValue=c[1040+50*a.saveStateSlot];a.isVBlankInterruptEnabled=F(1041+50*a.saveStateSlot);a.isLcdInterruptEnabled=F(1042+50*a.saveStateSlot);a.isTimerInterruptEnabled=F(1043+50*a.saveStateSlot);a.isSerialInterruptEnabled=F(1044+50*a.saveStateSlot);
a.isJoypadInterruptEnabled=F(1045+50*a.saveStateSlot);a.interruptsRequestedValue=c[1056+50*a.saveStateSlot];a.isVBlankInterruptRequested=F(1057+50*a.saveStateSlot);a.isLcdInterruptRequested=F(1058+50*a.saveStateSlot);a.isTimerInterruptRequested=F(1059+50*a.saveStateSlot);a.isSerialInterruptRequested=F(1060+50*a.saveStateSlot);a.isJoypadInterruptRequested=F(1061+50*a.saveStateSlot)};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=
1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=
!1;a.saveStateSlot=2;return a}();
function wb(a){xb(!1);var b=B(Q.memoryLocationInterruptRequest);b=u(a,b);Q.interruptsRequestedValue=b;G(Q.memoryLocationInterruptRequest,b);f.stackPointer-=2;f.isHalted();b=f.stackPointer;var d=f.programCounter,g=t(d);G(b+0,d&255);G(b+1,g);switch(a){case Q.bitPositionVBlankInterrupt:Q.isVBlankInterruptRequested=!1;f.programCounter=64;break;case Q.bitPositionLcdInterrupt:Q.isLcdInterruptRequested=!1;f.programCounter=72;break;case Q.bitPositionTimerInterrupt:Q.isTimerInterruptRequested=!1;f.programCounter=
80;break;case Q.bitPositionSerialInterrupt:Q.isSerialInterruptRequested=!1;f.programCounter=88;break;case Q.bitPositionJoypadInterrupt:Q.isJoypadInterruptRequested=!1,f.programCounter=96}}function yb(a){var b=B(Q.memoryLocationInterruptRequest);b|=1<<a;Q.interruptsRequestedValue=b;G(Q.memoryLocationInterruptRequest,b)}function xb(a){a?Q.masterInterruptSwitchDelay=!0:Q.masterInterruptSwitch=!1}
var S=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var b=a.dividerRegister;a.dividerRegister=0;G(a.memoryLocationDividerRegister,0);a.timerEnabled&&zb(b,0)&&Ab()};a.updateTimerCounter=function(b){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=b};a.updateTimerModulo=function(b){a.timerModulo=b;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=b,a.timerCounterWasReset=
!1)};a.updateTimerControl=function(b){var d=a.timerEnabled;a.timerEnabled=x(2,b);b&=3;if(!d){d=Cb(a.timerInputClock);var g=Cb(b),h=a.dividerRegister;(a.timerEnabled?x(d,h):x(d,h)&&x(g,h))&&Ab()}a.timerInputClock=b};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.currentCycles;c[1028+50*a.saveStateSlot]=a.dividerRegister;c[1032+50*a.saveStateSlot]=a.timerCounter;c[1036+50*a.saveStateSlot]=a.timerCounterOverflowDelay;c[1037+50*a.saveStateSlot]=a.timerCounterWasReset;c[1038+50*a.saveStateSlot]=a.timerCounterMask;
c[1042+50*a.saveStateSlot]=a.timerModulo;c[1046+50*a.saveStateSlot]=a.timerEnabled;c[1047+50*a.saveStateSlot]=a.timerInputClock};a.loadState=function(){a.currentCycles=c[1024+50*a.saveStateSlot];a.dividerRegister=c[1028+50*a.saveStateSlot];a.timerCounter=c[1032+50*a.saveStateSlot];a.timerCounterOverflowDelay=F(1036+50*a.saveStateSlot);a.timerCounterWasReset=F(1037+50*a.saveStateSlot);a.timerCounterMask=c[1038+50*a.saveStateSlot];a.timerModulo=c[1042+50*a.saveStateSlot];a.timerEnabled=F(1046+50*a.saveStateSlot);
a.timerInputClock=c[1047+50*a.saveStateSlot]};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}();
function Db(a){for(var b=0;b<a;){var d=S.dividerRegister,g=d;b+=4;g+=4;g&=65535;S.dividerRegister=g;if(S.timerEnabled){var h=S.timerCounterWasReset;S.timerCounterOverflowDelay?(S.timerCounter=S.timerModulo,Q.isTimerInterruptRequested=!0,yb(Q.bitPositionTimerInterrupt),S.timerCounterOverflowDelay=!1,S.timerCounterWasReset=!0):h&&(S.timerCounterWasReset=!1);zb(d,g)&&Ab()}}}function Ab(){var a=S.timerCounter;255<++a&&(S.timerCounterOverflowDelay=!0,a=0);S.timerCounter=a}
function zb(a,b){var d=Cb(S.timerInputClock);return x(d,a)&&!x(d,b)}function Cb(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}
var Eb=function(){function a(){}a.updateTransferControl=function(b){a.isShiftClockInternal=x(0,b);a.isClockSpeedFast=x(1,b);a.transferStartFlag=x(7,b);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=65281;a.memoryLocationSerialTransferControl=65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),T=function(){function a(){}a.updateJoypad=function(b){a.joypadRegisterFlipped=b^255;a.isDpadType=x(4,a.joypadRegisterFlipped);
a.isButtonType=x(5,a.joypadRegisterFlipped)};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.joypadRegisterFlipped;c[1025+50*a.saveStateSlot]=a.isDpadType;c[1026+50*a.saveStateSlot]=a.isButtonType};a.loadState=function(){a.joypadRegisterFlipped=c[1024+50*a.saveStateSlot];a.isDpadType=F(1025+50*a.saveStateSlot);a.isButtonType=F(1026+50*a.saveStateSlot)};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=
!1;a.isButtonType=!1;a.saveStateSlot=3;return a}();function Fb(a){var b=f.isStopped=!1;Gb(a)||(b=!0);Hb(a,!0);b&&(b=!1,3>=a&&(b=!0),a=!1,T.isDpadType&&b&&(a=!0),T.isButtonType&&!b&&(a=!0),a&&(Q.isJoypadInterruptRequested=!0,yb(Q.bitPositionJoypadInterrupt)))}function Gb(a){switch(a){case 0:return T.up;case 1:return T.right;case 2:return T.down;case 3:return T.left;case 4:return T.a;case 5:return T.b;case 6:return T.select;case 7:return T.start;default:return!1}}
function Hb(a,b){switch(a){case 0:T.up=b;break;case 1:T.right=b;break;case 2:T.down=b;break;case 3:T.left=b;break;case 4:T.a=b;break;case 5:T.b=b;break;case 6:T.select=b;break;case 7:T.start=b}}function Ib(a,b,d){for(var g=0;g<d;++g){for(var h=Jb(a+g),w=b+g;40959<w;)w-=8192;Kb(w,h)}U.DMACycles+=(32<<f.GBCDoubleSpeed)*(d>>4)}
function Lb(a,b){if(a===f.memoryLocationSpeedSwitch)return G(f.memoryLocationSpeedSwitch,b&1),!1;if(f.BootROMEnabled&&a===f.memoryLocationBootROMSwitch)return f.BootROMEnabled=!1,f.programCounter=255,!0;var d=U.videoRamLocation,g=U.spriteInformationTableLocation;if(a<d){if(!U.isRomOnly){d=U.isMBC1;var h=U.isMBC2;if(8191>=a){if(!h||x(4,b))b&=15,0===b?U.isRamBankingEnabled=!1:10===b&&(U.isRamBankingEnabled=!0)}else 16383>=a?(g=U.isMBC5,!g||12287>=a?(a=U.currentRomBank,h&&(a=b&15),d?(b&=31,a&=224):U.isMBC3?
(b&=127,a&=128):g&&(a&=0),U.currentRomBank=a|b):U.currentRomBank=r(0<b,U.currentRomBank&255)):!h&&24575>=a?d&&U.isMBC1RomModeEnabled?(a=U.currentRomBank&31,U.currentRomBank=a|b&224):(b=U.isMBC5?b&15:b&3,U.currentRamBank=b):!h&&32767>=a&&d&&(U.isMBC1RomModeEnabled=x(0,b))}return!1}if(a>=d&&a<U.cartridgeRamLocation)return!0;if(a>=U.echoRamLocation&&a<g)return G(a-8192,b),!0;if(a>=g&&a<=U.spriteInformationTableLocationEnd)return 2<=V.currentLcdMode;if(a>=U.unusableMemoryLocation&&a<=U.unusableMemoryEndLocation)return!1;
if(a===Eb.memoryLocationSerialTransferControl)return Eb.updateTransferControl(b);if(65296<=a&&65318>=a){pb();if(a===E.memoryLocationNR52||E.NR52IsSoundEnabled){switch(a){case I.memoryLocationNRx0:I.updateNRx0(b);break;case N.memoryLocationNRx0:N.updateNRx0(b);break;case I.memoryLocationNRx1:I.updateNRx1(b);break;case M.memoryLocationNRx1:M.updateNRx1(b);break;case N.memoryLocationNRx1:N.updateNRx1(b);break;case O.memoryLocationNRx1:O.updateNRx1(b);break;case I.memoryLocationNRx2:I.updateNRx2(b);break;
case M.memoryLocationNRx2:M.updateNRx2(b);break;case N.memoryLocationNRx2:N.volumeCodeChanged=!0;N.updateNRx2(b);break;case O.memoryLocationNRx2:O.updateNRx2(b);break;case I.memoryLocationNRx3:I.updateNRx3(b);break;case M.memoryLocationNRx3:M.updateNRx3(b);break;case N.memoryLocationNRx3:N.updateNRx3(b);break;case O.memoryLocationNRx3:O.updateNRx3(b);break;case I.memoryLocationNRx4:I.updateNRx4(b);break;case M.memoryLocationNRx4:M.updateNRx4(b);break;case N.memoryLocationNRx4:N.updateNRx4(b);break;
case O.memoryLocationNRx4:O.updateNRx4(b);break;case E.memoryLocationNR50:E.updateNR50(b);P.mixerVolumeChanged=!0;break;case E.memoryLocationNR51:E.updateNR51(b);P.mixerEnabledChanged=!0;break;case E.memoryLocationNR52:a=E.NR52IsSoundEnabled;!a&&x(7,b)&&(E.frameSequencer=7,I.waveFormPositionOnDuty=0,M.waveFormPositionOnDuty=0);if(a&&!x(7,b))for(a=65296;65318>a;++a)Kb(a,0);E.updateNR52(b)}b=!0}else b=!1;return b}if(65328<=a&&65343>=a)return pb(),N.isEnabled?(N.handleWaveRamWrite(b),!1):!0;if(a>=V.memoryLocationLcdControl&&
a<=D.memoryLocationWindowX){if(a===V.memoryLocationLcdControl)return V.updateLcdControl(b),!0;if(a===V.memoryLocationLcdStatus)return V.updateLcdStatus(b),!1;if(a===D.memoryLocationScanlineRegister)return D.scanlineRegister=0,G(a,0),!1;if(a===V.memoryLocationCoincidenceCompare)return V.coincidenceCompare=b,!0;if(a===D.memoryLocationDmaTransfer){b<<=8;for(a=0;159>=a;++a)d=B(b+a),G(U.spriteInformationTableLocation+a,d);U.DMACycles=644;return!0}switch(a){case D.memoryLocationScrollX:D.scrollX=b;break;
case D.memoryLocationScrollY:D.scrollY=b;break;case D.memoryLocationWindowX:D.windowX=b;break;case D.memoryLocationWindowY:D.windowY=b}return!0}if(a===U.memoryLocationHdmaTrigger)return f.GBCEnabled&&(U.isHblankHdmaActive&&!x(7,b)?(U.isHblankHdmaActive=!1,b=B(U.memoryLocationHdmaTrigger),G(U.memoryLocationHdmaTrigger,b|128)):(a=B(U.memoryLocationHdmaSourceHigh),d=B(U.memoryLocationHdmaSourceLow),a=r(a,d)&65520,d=B(U.memoryLocationHdmaDestinationHigh),g=B(U.memoryLocationHdmaDestinationLow),d=r(d,
g),d=(d&8176)+U.videoRamLocation,g=u(7,b),g=g+1<<4,x(7,b)?(U.isHblankHdmaActive=!0,U.hblankHdmaTransferLengthRemaining=g,U.hblankHdmaSource=a,U.hblankHdmaDestination=d,G(U.memoryLocationHdmaTrigger,u(7,b))):(Ib(a,d,g),G(U.memoryLocationHdmaTrigger,255)))),!1;if((a===U.memoryLocationGBCWRAMBank||a===U.memoryLocationGBCVRAMBank)&&U.isHblankHdmaActive&&(d=U.hblankHdmaSource,16384<=d&&32767>=d||53248<=d&&57343>=d))return!1;if(a>=bb.memoryLocationBackgroundPaletteIndex&&a<=bb.memoryLocationSpritePaletteData){d=
bb.memoryLocationSpritePaletteData;if(a===bb.memoryLocationBackgroundPaletteData||a===d)g=B(a-1),g=u(6,g),h=g&63,a===d&&(h+=64),c[ca+h]=b,b=g,--a,x(7,b)&&G(a,b+1|128);return!0}if(a>=S.memoryLocationDividerRegister&&a<=S.memoryLocationTimerControl){Db(S.currentCycles);S.currentCycles=0;switch(a){case S.memoryLocationDividerRegister:return S.updateDividerRegister(),!1;case S.memoryLocationTimerCounter:S.updateTimerCounter(b);break;case S.memoryLocationTimerModulo:S.updateTimerModulo(b);break;case S.memoryLocationTimerControl:S.updateTimerControl(b)}return!0}a===
T.memoryLocationJoypadRegister&&T.updateJoypad(b);if(a===Q.memoryLocationInterruptRequest)return Q.updateInterruptRequested(b),!0;a===Q.memoryLocationInterruptEnabled&&Q.updateInterruptEnabled(b);return!0}
function Mb(a){switch(a>>12){case 0:if(f.BootROMEnabled)if(f.GBCEnabled){if(256>a||511<a&&2304>a)return a+qa}else if(!f.GBCEnabled&&256>a)return a+qa;case 1:case 2:case 3:return a+ra;case 4:case 5:case 6:case 7:var b=U.currentRomBank;U.isMBC5||0!==b||(b=1);return 16384*b+(a-U.switchableCartridgeRomLocation)+ra;case 8:case 9:return b=0,f.GBCEnabled&&(b=B(U.memoryLocationGBCVRAMBank)&1),a-U.videoRamLocation+2048+8192*b;case 10:case 11:return 8192*U.currentRamBank+(a-U.cartridgeRamLocation)+pa;case 12:return a-
U.internalRamBankZeroLocation+18432;case 13:return b=0,f.GBCEnabled&&(b=B(U.memoryLocationGBCWRAMBank)&7),a-U.internalRamBankZeroLocation+18432+4096*((1>b?1:b)-1);default:return a-U.echoRamLocation+51200}}var Nb=function(){function a(){}a.programCounter=-1;a.readGbMemory=-1;a.writeGbMemory=-1;a.reachedBreakpoint=!1;return a}();function G(a,b){a=Mb(a);c[a]=b}function Kb(a,b){a===Nb.writeGbMemory&&(Nb.reachedBreakpoint=!0);Lb(a,b)&&G(a,b)}
var V=function(){function a(){}a.updateLcdStatus=function(b){var d=B(a.memoryLocationLcdStatus);b=b&248|d&7|128;G(a.memoryLocationLcdStatus,b)};a.updateLcdControl=function(b){var d=a.enabled;a.enabled=x(7,b);a.windowTileMapDisplaySelect=x(6,b);a.windowDisplayEnabled=x(5,b);a.bgWindowTileDataSelect=x(4,b);a.bgTileMapDisplaySelect=x(3,b);a.tallSpriteSize=x(2,b);a.spriteDisplayEnable=x(1,b);a.bgDisplayEnabled=x(0,b);d&&!a.enabled&&Ob(!0);!d&&a.enabled&&Ob(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=
0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}();
function Ob(a){D.scanlineCycleCounter=0;D.scanlineRegister=0;G(D.memoryLocationScanlineRegister,0);var b=B(V.memoryLocationLcdStatus);b=u(1,b);b=u(0,b);V.currentLcdMode=0;G(V.memoryLocationLcdStatus,b);if(a)for(a=0;93184>a;++a)c[ea+a]=255}function Pb(a,b){0!==a&&1!==a||D.scanlineRegister!==V.coincidenceCompare?b=u(2,b):(b|=4,x(6,b)&&(Q.isLcdInterruptRequested=!0,yb(Q.bitPositionLcdInterrupt)));return b}
function Qb(a,b,d,g,h,w){for(var A=g>>3;160>h;++h){var z=h+w;256<=z&&(z-=256);var v=d+(A<<5)+(z>>3),y=kb(v,0),J=!1;if(e.tileCaching){var C=h;var K=a,X=z,Ma=v,R=y,L=0,H=hb.nextXIndexToPerformCacheCheck;if(0<K&&8<C&&R===hb.tileId&&C===H){R=x(5,B(Ma-1));Ma=x(5,B(Ma));for(var Y=0;8>Y;++Y){R!==Ma&&(Y=7-Y);var Na=C+Y;if(160>=Na){var Bb=C-(8-Y),Ub=ea+3*(160*K+Na);Rb(Na,K,0,c[Ub]);Rb(Na,K,1,c[Ub]);Rb(Na,K,2,c[Ub]);Bb=c[da+(160*K+Bb)];gb(Na,K,u(2,Bb),x(2,Bb));L++}}}else hb.tileId=R;C>=H&&(H=C+8,K=X&7|0,C<
K&&(H+=K));hb.nextXIndexToPerformCacheCheck=H;C=L;0<C&&(h+=C-1,J=!0)}e.tileRendering&&!J?(J=h,C=a,K=z,z=b,L=g&7|0,H=0,0==J&&(H=K-(K>>3<<3)),K=7,160<J+8&&(K=160-J),X=-1,R=0,f.GBCEnabled&&(X=kb(v,1),R=x(3,X)|0,x(6,X)&&(L=7-L)),C=ib(y,z,R,H,K,L,J,C,160,ea,!1,0,X,-1),0<C&&(h+=C-1)):J||(f.GBCEnabled?(J=h,C=a,H=g,L=jb(b,y),y=kb(v,1),H=H&7|0,x(6,y)&&(H=7-H),K=x(3,y)|0,v=kb(L+2*H,K),L=kb(L+2*H+1,K),H=z&7|0,x(5,y)||(H=7-H),z=0,x(H,L)&&(z=z+1<<1),x(H,v)&&(z+=1),H=db(y&7,z,!1),v=fb(0,H),L=fb(1,H),H=fb(2,H),
Rb(J,C,0,v),Rb(J,C,1,L),Rb(J,C,2,H),gb(J,C,z,x(7,y))):(v=h,J=a,L=g,C=jb(b,y),L=L&7|0,y=kb(C+2*L,0),C=kb(C+2*L+1,0),L=z&7|0,L=7-L,z=0,x(L,C)&&(z=z+1<<1),x(L,y)&&(z+=1),y=cb(z,D.memoryLocationBackgroundPalette),Rb(v,J,0,(y&16711680)>>16),Rb(v,J,1,(y&65280)>>8),Rb(v,J,2,y&255),gb(v,J,z)))}}
var D=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return 153===a.scanlineRegister?4<<f.GBCDoubleSpeed:456<<f.GBCDoubleSpeed};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return 376<<f.GBCDoubleSpeed};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return 249<<f.GBCDoubleSpeed};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;c[1028+50*a.saveStateSlot]=a.scanlineRegister;c[1029+50*a.saveStateSlot]=
a.scrollX;c[1030+50*a.saveStateSlot]=a.scrollY;c[1031+50*a.saveStateSlot]=a.windowX;c[1032+50*a.saveStateSlot]=a.windowY;c[1033+50*a.saveStateSlot]=V.currentLcdMode;c[1034+50*a.saveStateSlot]=V.coincidenceCompare;c[1035+50*a.saveStateSlot]=V.enabled;c[1036+50*a.saveStateSlot]=V.windowTileMapDisplaySelect;c[1037+50*a.saveStateSlot]=V.windowDisplayEnabled;c[1038+50*a.saveStateSlot]=V.bgWindowTileDataSelect;c[1039+50*a.saveStateSlot]=V.bgTileMapDisplaySelect;c[1040+50*a.saveStateSlot]=V.tallSpriteSize;
c[1041+50*a.saveStateSlot]=V.spriteDisplayEnable;c[1042+50*a.saveStateSlot]=V.bgDisplayEnabled};a.loadState=function(){a.scanlineCycleCounter=c[1024+50*a.saveStateSlot];a.scanlineRegister=c[1028+50*a.scanlineRegister];a.scrollX=c[1029+50*a.saveStateSlot];a.scrollY=c[1030+50*a.saveStateSlot];a.windowX=c[1031+50*a.saveStateSlot];a.windowY=c[1032+50*a.saveStateSlot];V.currentLcdMode=c[1033+50*a.saveStateSlot];V.coincidenceCompare=c[1034+50*a.saveStateSlot];V.enabled=F(1035+50*a.saveStateSlot);V.windowTileMapDisplaySelect=
F(1036+50*a.saveStateSlot);V.windowDisplayEnabled=F(1037+50*a.saveStateSlot);V.bgWindowTileDataSelect=F(1038+50*a.saveStateSlot);V.bgTileMapDisplaySelect=F(1039+50*a.saveStateSlot);V.tallSpriteSize=F(1040+50*a.saveStateSlot);V.spriteDisplayEnable=F(1041+50*a.saveStateSlot);V.bgDisplayEnabled=F(1042+50*a.saveStateSlot)};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=
65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}();
function Sb(a){if(V.enabled)for(D.scanlineCycleCounter+=a,a=e.graphicsDisableScanlineRendering;D.scanlineCycleCounter>=D.MAX_CYCLES_PER_SCANLINE();){D.scanlineCycleCounter-=D.MAX_CYCLES_PER_SCANLINE();var b=D.scanlineRegister;if(144===b){if(a)for(var d=0;144>=d;++d)Tb(d);else Tb(b);for(d=0;144>d;++d)for(var g=0;160>g;++g)c[da+(160*d+g)]=0;hb.tileId=-1;hb.nextXIndexToPerformCacheCheck=-1}else 144>b&&(a||Tb(b));b=153<b?0:b+1;D.scanlineRegister=b}if(V.enabled){b=D.scanlineRegister;d=V.currentLcdMode;
a=0;if(144<=b)a=1;else{g=D.scanlineCycleCounter;var h=D.MIN_CYCLES_SPRITES_LCD_MODE();g>=h?a=2:g>=h&&(a=3)}if(d!==a){b=B(V.memoryLocationLcdStatus);V.currentLcdMode=a;d=!1;switch(a){case 0:b=u(0,b);b=u(1,b);d=x(3,b);break;case 1:b=u(1,b);b|=1;d=x(4,b);break;case 2:b=u(0,b);b|=2;d=x(5,b);break;case 3:b|=3}d&&(Q.isLcdInterruptRequested=!0,yb(Q.bitPositionLcdInterrupt));0===a&&U.isHblankHdmaActive&&(g=16,d=U.hblankHdmaTransferLengthRemaining,d<g&&(g=d),Ib(U.hblankHdmaSource,U.hblankHdmaDestination,g),
U.hblankHdmaSource+=g,U.hblankHdmaDestination+=g,d-=g,U.hblankHdmaTransferLengthRemaining=d,g=U.memoryLocationHdmaTrigger,0>=d?(U.isHblankHdmaActive=!1,G(g,255)):G(g,u(7,(d>>4)-1)));1===a&&(Q.isVBlankInterruptRequested=!0,yb(Q.bitPositionVBlankInterrupt));b=Pb(a,b);G(V.memoryLocationLcdStatus,b)}else 153===b&&(b=B(V.memoryLocationLcdStatus),b=Pb(a,b),G(V.memoryLocationLcdStatus,b))}}
function Tb(a){var b=D.memoryLocationTileDataSelectZeroStart;V.bgWindowTileDataSelect&&(b=D.memoryLocationTileDataSelectOneStart);if(f.GBCEnabled||V.bgDisplayEnabled){var d=D.memoryLocationTileMapSelectZeroStart;V.bgTileMapDisplaySelect&&(d=D.memoryLocationTileMapSelectOneStart);Qb(a,b,d,a+D.scrollY&255,0,D.scrollX)}if(V.windowDisplayEnabled){d=D.memoryLocationTileMapSelectZeroStart;V.windowTileMapDisplaySelect&&(d=D.memoryLocationTileMapSelectOneStart);var g=D.windowX,h=D.windowY;a<h||(g-=7,Qb(a,
b,d,a-h,g,-g|0))}if(V.spriteDisplayEnable)for(b=V.tallSpriteSize,d=39;0<=d;--d){h=4*d;var w=D.memoryLocationSpriteAttributesTable+h,A=B(w+0);g=B(w+1);var z=B(w+2);A-=16;g-=8;var v=8;b&&(v=16,z-=z&1);if(a>=A&&a<A+v){h=B(D.memoryLocationSpriteAttributesTable+h+3);w=x(7,h);var y=x(6,h),J=x(5,h);A=a-A;y&&(A=v-A,--A);A<<=1;z=jb(D.memoryLocationTileDataSelectOneStart,z);z+=A;v=f.GBCEnabled&&x(3,h);A=kb(z+0,v);z=kb(z+1,v);for(v=7;0<=v;--v){y=v;J&&(y-=7,y=-y);var C=0;x(y,z)&&(C=C+1<<1);x(y,A)&&(C+=1);if(0!==
C&&(y=g+(7-v),0<=y&&160>=y)){var K=f.GBCEnabled&&!V.bgDisplayEnabled,X=!1,Ma=!1;if(!K){var R=c[da+(160*a+y)],L=R&3;w&&0<L?X=!0:f.GBCEnabled&&x(2,R)&&0<L&&(Ma=!0)}if(K||!X&&!Ma)f.GBCEnabled?(X=db(h&7,C,!0),C=fb(0,X),K=fb(1,X),X=fb(2,X),Rb(y,a,0,C),Rb(y,a,1,K),Rb(y,a,2,X)):(K=D.memoryLocationSpritePaletteOne,x(4,h)&&(K=D.memoryLocationSpritePaletteTwo),C=cb(C,K),Rb(y,a,0,(C&16711680)>>16),Rb(y,a,1,(C&65280)>>8),Rb(y,a,2,C&255))}}}}}function Rb(a,b,d,g){c[ea+3*(160*b+a)+d]=g}
function kb(a,b){return c[a-U.videoRamLocation+2048+8192*(b&1)]}
function Vb(a){var b=U.videoRamLocation;return a<b||a>=b&&a<U.cartridgeRamLocation?-1:a>=U.echoRamLocation&&a<U.spriteInformationTableLocation?B(a-8192):a>=U.spriteInformationTableLocation&&a<=U.spriteInformationTableLocationEnd?2>V.currentLcdMode?255:-1:a===f.memoryLocationSpeedSwitch?(a=255,b=B(f.memoryLocationSpeedSwitch),x(0,b)||(a=u(0,a)),f.GBCDoubleSpeed||(a=u(7,a)),a):a===D.memoryLocationScanlineRegister?(G(a,D.scanlineRegister),D.scanlineRegister):65296<=a&&65318>=a?(pb(),vb(a)):65319<=a&&
65327>=a?255:65328<=a&&65343>=a?(pb(),N.isEnabled?N.handleWaveRamRead():-1):a===S.memoryLocationDividerRegister?(b=t(S.dividerRegister),G(a,b),b):a===S.memoryLocationTimerCounter?(G(a,S.timerCounter),S.timerCounter):a===Q.memoryLocationInterruptRequest?224|Q.interruptsRequestedValue:a===T.memoryLocationJoypadRegister?(a=T.joypadRegisterFlipped,T.isDpadType?(a=T.up?u(2,a):a|4,a=T.right?u(0,a):a|1,a=T.down?u(3,a):a|8,a=T.left?u(1,a):a|2):T.isButtonType&&(a=T.a?u(0,a):a|1,a=T.b?u(1,a):a|2,a=T.select?
u(2,a):a|4,a=T.start?u(3,a):a|8),a|240):-1}function B(a){return c[Mb(a)]}function Jb(a){a===Nb.readGbMemory&&(Nb.reachedBreakpoint=!0);var b=Vb(a);return-1===b?B(a):b}function F(a){return 0<c[a]}
var U=function(){function a(){}a.saveState=function(){c[1024+50*a.saveStateSlot]=a.currentRomBank;c[1026+50*a.saveStateSlot]=a.currentRamBank;c[1028+50*a.saveStateSlot]=a.isRamBankingEnabled;c[1029+50*a.saveStateSlot]=a.isMBC1RomModeEnabled;c[1030+50*a.saveStateSlot]=a.isRomOnly;c[1031+50*a.saveStateSlot]=a.isMBC1;c[1032+50*a.saveStateSlot]=a.isMBC2;c[1033+50*a.saveStateSlot]=a.isMBC3;c[1034+50*a.saveStateSlot]=a.isMBC5;c[1035+50*a.saveStateSlot]=a.DMACycles;c[1039+50*a.saveStateSlot]=a.isHblankHdmaActive;
c[1040+50*a.saveStateSlot]=a.hblankHdmaTransferLengthRemaining;c[1044+50*a.saveStateSlot]=a.hblankHdmaSource;c[1048+50*a.saveStateSlot]=a.hblankHdmaDestination};a.loadState=function(){a.currentRomBank=c[1024+50*a.saveStateSlot];a.currentRamBank=c[1026+50*a.saveStateSlot];a.isRamBankingEnabled=F(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=F(1029+50*a.saveStateSlot);a.isRomOnly=F(1030+50*a.saveStateSlot);a.isMBC1=F(1031+50*a.saveStateSlot);a.isMBC2=F(1032+50*a.saveStateSlot);a.isMBC3=F(1033+50*
a.saveStateSlot);a.isMBC5=F(1034+50*a.saveStateSlot);a.DMACycles=c[1035+50*a.saveStateSlot];a.isHblankHdmaActive=F(1039+50*a.saveStateSlot);a.hblankHdmaTransferLengthRemaining=c[1040+50*a.saveStateSlot];a.hblankHdmaSource=c[1044+50*a.saveStateSlot];a.hblankHdmaDestination=c[1048+50*a.saveStateSlot]};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=
57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=
0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),f=function(){function a(){}a.CLOCK_SPEED=function(){return 4194304<<a.GBCDoubleSpeed};a.MAX_CYCLES_PER_FRAME=function(){return 70224<<a.GBCDoubleSpeed};a.enableHalt=function(){Q.masterInterruptSwitch?a.isHaltNormal=!0:0===(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)?a.isHaltNoJump=
!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump};a.saveState=function(){c[1024+50*a.saveStateSlot]=a.registerA;c[1025+50*a.saveStateSlot]=a.registerB;c[1026+50*a.saveStateSlot]=a.registerC;c[1027+50*a.saveStateSlot]=a.registerD;c[1028+50*a.saveStateSlot]=a.registerE;c[1029+50*a.saveStateSlot]=a.registerH;c[1030+50*a.saveStateSlot]=a.registerL;c[1031+50*a.saveStateSlot]=a.registerF;
c[1032+50*a.saveStateSlot]=a.stackPointer;c[1034+50*a.saveStateSlot]=a.programCounter;c[1036+50*a.saveStateSlot]=a.currentCycles;c[1041+50*a.saveStateSlot]=a.isHaltNormal;c[1042+50*a.saveStateSlot]=a.isHaltNoJump;c[1043+50*a.saveStateSlot]=a.isHaltBug;c[1044+50*a.saveStateSlot]=a.isStopped;c[1045+50*a.saveStateSlot]=a.BootROMEnabled;c[1046+50*a.saveStateSlot]=a.GBCEnabled;c[1047+50*a.saveStateSlot]=a.GBCDoubleSpeed};a.loadState=function(){a.registerA=c[1024+50*a.saveStateSlot];a.registerB=c[1025+
50*a.saveStateSlot];a.registerC=c[1026+50*a.saveStateSlot];a.registerD=c[1027+50*a.saveStateSlot];a.registerE=c[1028+50*a.saveStateSlot];a.registerH=c[1029+50*a.saveStateSlot];a.registerL=c[1030+50*a.saveStateSlot];a.registerF=c[1031+50*a.saveStateSlot];a.stackPointer=c[1032+50*a.saveStateSlot];a.programCounter=c[1034+50*a.saveStateSlot];a.currentCycles=c[1036+50*a.saveStateSlot];a.isHaltNormal=F(1041+50*a.saveStateSlot);a.isHaltNoJump=F(1042+50*a.saveStateSlot);a.isHaltBug=F(1043+50*a.saveStateSlot);
a.isStopped=F(1044+50*a.saveStateSlot);a.BootROMEnabled=F(1045+50*a.saveStateSlot);a.GBCEnabled=F(1046+50*a.saveStateSlot);a.GBCDoubleSpeed=F(1047+50*a.saveStateSlot)};a.memoryLocationBootROMSwitch=65360;a.BootROMEnabled=!1;a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=
!1;a.isStopped=!1;a.saveStateSlot=0;return a}();function Wb(a){var b=f.registerA;ya(b,a);za(b,a);b=b+a&255;f.registerA=b;k(0===b);l(0)}function Xb(a){var b=f.registerA,d=b+a+xa()&255;m(0!=((b^a^d)&16));a=b+a+xa()&65535;n(0<(a&256));f.registerA=d;k(0===d);l(0)}function Yb(a){var b=-1*a;var d=f.registerA;ya(d,b);za(d,b);d=d-a&255;f.registerA=d;k(0===d);l(1)}function Zb(a){var b=f.registerA,d=b-a-xa()&255;m(0!=((b^a^d)&16));a=b-a-xa()&65535;n(0<(a&256));f.registerA=d;k(0===d);l(1)}
function $b(a){a&=f.registerA;f.registerA=a;k(0===a);l(0);m(1);n(0)}function ac(a){a=(f.registerA^a)&255;f.registerA=a;k(0===a);l(0);m(0);n(0)}function bc(a){a|=f.registerA;f.registerA=a;k(0===a);l(0);m(0);n(0)}function cc(a){var b=f.registerA;a*=-1;ya(b,a);za(b,a);k(0===b+a);l(1)}function dc(a,b){k(0===(b&1<<a));l(0);m(1);return b}function ec(a,b,d){return 0<b?d|1<<a:d&~(1<<a)}function fc(a){var b=f.programCounter;b=(b+(a<<24>>24)&65535)+1&65535;f.programCounter=b}
function gc(a){var b=f.programCounter;b=b+1&65535;f.isHaltBug&&(b=b-1&65535);f.programCounter=b;switch((a&240)>>4){case 0:return hc(a);case 1:return ic(a);case 2:return jc(a);case 3:return kc(a);case 4:return lc(a);case 5:return mc(a);case 6:return nc(a);case 7:return oc(a);case 8:return pc(a);case 9:return qc(a);case 10:return rc(a);case 11:return sc(a);case 12:return tc(a);case 13:return uc(a);case 14:return vc(a);default:return wc(a)}}function W(a){xc(4);return Jb(a)}
function yc(a,b){xc(4);Kb(a,b)}function zc(a){xc(8);var b=Vb(a);b=-1===b?B(a):b;a+=1;var d=Vb(a);a=-1===d?B(a):d;return r(a,b)}function Ac(a,b){xc(8);var d=t(b);b&=255;Lb(a,b)&&G(a,b);a+=1;Lb(a,d)&&G(a,d)}function Z(){xc(4);return B(f.programCounter)}function Bc(){xc(4);var a=B(f.programCounter+1&65535);return r(a,Z())}
function hc(a){switch(a){case 0:return 4;case 1:return a=Bc(),f.registerB=t(a),f.registerC=a&255,f.programCounter=f.programCounter+2&65535,4;case 2:return yc(r(f.registerB,f.registerC),f.registerA),4;case 3:return a=r(f.registerB,f.registerC),a++,f.registerB=t(a),f.registerC=a&255,8;case 4:return a=f.registerB,ya(a,1),a=a+1&255,f.registerB=a,k(0===a),l(0),4;case 5:return a=f.registerB,ya(a,-1),a=a-1&255,f.registerB=a,k(0===a),l(1),4;case 6:return f.registerB=Z(),f.programCounter=f.programCounter+
1&65535,4;case 7:return a=f.registerA,n(128===(a&128)),f.registerA=(a<<1|a>>7)&255,k(0),l(0),m(0),4;case 8:return Ac(Bc(),f.stackPointer),f.programCounter=f.programCounter+2&65535,4;case 9:a=r(f.registerH,f.registerL);var b=r(f.registerB,f.registerC);Aa(a,b,!1);a=a+b&65535;f.registerH=t(a);f.registerL=a&255;l(0);return 8;case 10:return f.registerA=W(r(f.registerB,f.registerC)),4;case 11:return a=r(f.registerB,f.registerC),a=a-1&65535,f.registerB=t(a),f.registerC=a&255,8;case 12:return a=f.registerC,
ya(a,1),a=a+1&255,f.registerC=a,k(0===a),l(0),4;case 13:return a=f.registerC,ya(a,-1),a=a-1&255,f.registerC=a,k(0===a),l(1),4;case 14:return f.registerC=Z(),f.programCounter=f.programCounter+1&65535,4;case 15:return a=f.registerA,n(0<(a&1)),f.registerA=(a>>1|a<<7)&255,k(0),l(0),m(0),4}return-1}
function ic(a){switch(a){case 16:if(f.GBCEnabled&&(a=W(f.memoryLocationSpeedSwitch),x(0,a)))return a=u(0,a),x(7,a)?(f.GBCDoubleSpeed=!1,a=u(7,a)):(f.GBCDoubleSpeed=!0,a|=128),yc(f.memoryLocationSpeedSwitch,a),68;f.isStopped=!0;f.programCounter=f.programCounter+1&65535;return 4;case 17:return a=Bc(),f.registerD=t(a),f.registerE=a&255,f.programCounter=f.programCounter+2&65535,4;case 18:return yc(r(f.registerD,f.registerE),f.registerA),4;case 19:return a=r(f.registerD,f.registerE),a=a+1&65535,f.registerD=
t(a),f.registerE=a&255,8;case 20:return a=f.registerD,ya(a,1),f.registerD=a+1&255,k(0===f.registerD),l(0),4;case 21:return a=f.registerD,ya(a,-1),f.registerD=a-1&255,k(0===f.registerD),l(1),4;case 22:return f.registerD=Z(),f.programCounter=f.programCounter+1&65535,4;case 23:return a=128===(f.registerA&128),f.registerA=(f.registerA<<1|xa())&255,n(a),k(0),l(0),m(0),4;case 24:return fc(Z()),8;case 25:a=r(f.registerH,f.registerL);var b=r(f.registerD,f.registerE);Aa(a,b,!1);a=a+b&65535;f.registerH=t(a);
f.registerL=a&255;l(0);return 8;case 26:return a=r(f.registerD,f.registerE),f.registerA=W(a),4;case 27:return a=r(f.registerD,f.registerE),a=a-1&65535,f.registerD=t(a),f.registerE=a&255,8;case 28:return a=f.registerE,ya(a,1),a=a+1&255,f.registerE=a,k(0===a),l(0),4;case 29:return a=f.registerE,ya(a,-1),a=a-1&255,f.registerE=a,k(0===a),l(1),4;case 30:return f.registerE=Z(),f.programCounter=f.programCounter+1&65535,4;case 31:return a=1===(f.registerA&1),f.registerA=(f.registerA>>1|xa()<<7)&255,n(a),
k(0),l(0),m(0),4}return-1}
function jc(a){switch(a){case 32:return 0===wa()?fc(Z()):f.programCounter=f.programCounter+1&65535,8;case 33:return a=Bc(),f.registerH=t(a),f.registerL=a&255,f.programCounter=f.programCounter+2&65535,4;case 34:return a=r(f.registerH,f.registerL),yc(a,f.registerA),a=a+1&65535,f.registerH=t(a),f.registerL=a&255,4;case 35:return a=r(f.registerH,f.registerL),a=a+1&65535,f.registerH=t(a),f.registerL=a&255,8;case 36:return a=f.registerH,ya(a,1),a=a+1&255,f.registerH=a,k(0===a),l(0),4;case 37:return a=f.registerH,
ya(a,-1),a=a-1&255,f.registerH=a,k(0===a),l(1),4;case 38:return f.registerH=Z(),f.programCounter=f.programCounter+1&65535,4;case 39:a=0;0<(f.registerF>>5&1)&&(a|=6);0<xa()&&(a|=96);var b=f.registerA;0<(f.registerF>>6&1)?b=b-a&255:(9<(b&15)&&(a|=6),153<b&&(a|=96),b=b+a&255);k(0===b);n(0!==(a&96));m(0);f.registerA=b;return 4;case 40:return 0<wa()?fc(Z()):f.programCounter=f.programCounter+1&65535,8;case 41:return a=r(f.registerH,f.registerL),Aa(a,a,!1),a=2*a&65535,f.registerH=t(a),f.registerL=a&255,
l(0),8;case 42:return a=r(f.registerH,f.registerL),f.registerA=W(a),a=a+1&65535,f.registerH=t(a),f.registerL=a&255,4;case 43:return a=r(f.registerH,f.registerL),a=a-1&65535,f.registerH=t(a),f.registerL=a&255,8;case 44:return a=f.registerL,ya(a,1),a=a+1&255,f.registerL=a,k(0===a),l(0),4;case 45:return a=f.registerL,ya(a,-1),a=a-1&255,f.registerL=a,k(0===a),l(1),4;case 46:return f.registerL=Z(),f.programCounter=f.programCounter+1&65535,4;case 47:return f.registerA=~f.registerA,l(1),m(1),4}return-1}
function kc(a){switch(a){case 48:return 0===xa()?fc(Z()):f.programCounter=f.programCounter+1&65535,8;case 49:return f.stackPointer=Bc(),f.programCounter=f.programCounter+2&65535,4;case 50:return a=r(f.registerH,f.registerL),yc(a,f.registerA),a=a-1&65535,f.registerH=t(a),f.registerL=a&255,4;case 51:return f.stackPointer=f.stackPointer+1&65535,8;case 52:a=r(f.registerH,f.registerL);var b=W(a);ya(b,1);b=b+1&255;k(0===b);l(0);yc(a,b);return 4;case 53:return a=r(f.registerH,f.registerL),b=W(a),ya(b,-1),
b=b-1&255,k(0===b),l(1),yc(a,b),4;case 54:return yc(r(f.registerH,f.registerL),Z()),f.programCounter=f.programCounter+1&65535,4;case 55:return l(0),m(0),n(1),4;case 56:return 1===xa()?fc(Z()):f.programCounter=f.programCounter+1&65535,8;case 57:return a=r(f.registerH,f.registerL),Aa(a,f.stackPointer,!1),a=a+f.stackPointer&65535,f.registerH=t(a),f.registerL=a&255,l(0),8;case 58:return a=r(f.registerH,f.registerL),f.registerA=W(a),a=a-1&65535,f.registerH=t(a),f.registerL=a&255,4;case 59:return f.stackPointer=
f.stackPointer-1&65535,8;case 60:return a=f.registerA,ya(a,1),a=a+1&255,f.registerA=a,k(0===a),l(0),4;case 61:return a=f.registerA,ya(a,-1),a=a-1&255,f.registerA=a,k(0===a),l(1),4;case 62:return f.registerA=Z(),f.programCounter=f.programCounter+1&65535,4;case 63:return l(0),m(0),n(0>=xa()),4}return-1}
function lc(a){switch(a){case 64:return 4;case 65:return f.registerB=f.registerC,4;case 66:return f.registerB=f.registerD,4;case 67:return f.registerB=f.registerE,4;case 68:return f.registerB=f.registerH,4;case 69:return f.registerB=f.registerL,4;case 70:return f.registerB=W(r(f.registerH,f.registerL)),4;case 71:return f.registerB=f.registerA,4;case 72:return f.registerC=f.registerB,4;case 73:return 4;case 74:return f.registerC=f.registerD,4;case 75:return f.registerC=f.registerE,4;case 76:return f.registerC=
f.registerH,4;case 77:return f.registerC=f.registerL,4;case 78:return f.registerC=W(r(f.registerH,f.registerL)),4;case 79:return f.registerC=f.registerA,4}return-1}
function mc(a){switch(a){case 80:return f.registerD=f.registerB,4;case 81:return f.registerD=f.registerC,4;case 82:return 4;case 83:return f.registerD=f.registerE,4;case 84:return f.registerD=f.registerH,4;case 85:return f.registerD=f.registerL,4;case 86:return f.registerD=W(r(f.registerH,f.registerL)),4;case 87:return f.registerD=f.registerA,4;case 88:return f.registerE=f.registerB,4;case 89:return f.registerE=f.registerC,4;case 90:return f.registerE=f.registerD,4;case 91:return 4;case 92:return f.registerE=
f.registerH,4;case 93:return f.registerE=f.registerL,4;case 94:return f.registerE=W(r(f.registerH,f.registerL)),4;case 95:return f.registerE=f.registerA,4}return-1}
function nc(a){switch(a){case 96:return f.registerH=f.registerB,4;case 97:return f.registerH=f.registerC,4;case 98:return f.registerH=f.registerD,4;case 99:return f.registerH=f.registerE,4;case 100:return f.registerH=f.registerH,4;case 101:return f.registerH=f.registerL,4;case 102:return f.registerH=W(r(f.registerH,f.registerL)),4;case 103:return f.registerH=f.registerA,4;case 104:return f.registerL=f.registerB,4;case 105:return f.registerL=f.registerC,4;case 106:return f.registerL=f.registerD,4;
case 107:return f.registerL=f.registerE,4;case 108:return f.registerL=f.registerH,4;case 109:return f.registerL=f.registerL,4;case 110:return f.registerL=W(r(f.registerH,f.registerL)),4;case 111:return f.registerL=f.registerA,4}return-1}
function oc(a){switch(a){case 112:return yc(r(f.registerH,f.registerL),f.registerB),4;case 113:return yc(r(f.registerH,f.registerL),f.registerC),4;case 114:return yc(r(f.registerH,f.registerL),f.registerD),4;case 115:return yc(r(f.registerH,f.registerL),f.registerE),4;case 116:return yc(r(f.registerH,f.registerL),f.registerH),4;case 117:return yc(r(f.registerH,f.registerL),f.registerL),4;case 118:return U.isHblankHdmaActive||f.enableHalt(),4;case 119:return yc(r(f.registerH,f.registerL),f.registerA),
4;case 120:return f.registerA=f.registerB,4;case 121:return f.registerA=f.registerC,4;case 122:return f.registerA=f.registerD,4;case 123:return f.registerA=f.registerE,4;case 124:return f.registerA=f.registerH,4;case 125:return f.registerA=f.registerL,4;case 126:return f.registerA=W(r(f.registerH,f.registerL)),4;case 127:return 4}return-1}
function pc(a){switch(a){case 128:return Wb(f.registerB),4;case 129:return Wb(f.registerC),4;case 130:return Wb(f.registerD),4;case 131:return Wb(f.registerE),4;case 132:return Wb(f.registerH),4;case 133:return Wb(f.registerL),4;case 134:return a=W(r(f.registerH,f.registerL)),Wb(a),4;case 135:return Wb(f.registerA),4;case 136:return Xb(f.registerB),4;case 137:return Xb(f.registerC),4;case 138:return Xb(f.registerD),4;case 139:return Xb(f.registerE),4;case 140:return Xb(f.registerH),4;case 141:return Xb(f.registerL),
4;case 142:return a=W(r(f.registerH,f.registerL)),Xb(a),4;case 143:return Xb(f.registerA),4}return-1}
function qc(a){switch(a){case 144:return Yb(f.registerB),4;case 145:return Yb(f.registerC),4;case 146:return Yb(f.registerD),4;case 147:return Yb(f.registerE),4;case 148:return Yb(f.registerH),4;case 149:return Yb(f.registerL),4;case 150:return a=W(r(f.registerH,f.registerL)),Yb(a),4;case 151:return Yb(f.registerA),4;case 152:return Zb(f.registerB),4;case 153:return Zb(f.registerC),4;case 154:return Zb(f.registerD),4;case 155:return Zb(f.registerE),4;case 156:return Zb(f.registerH),4;case 157:return Zb(f.registerL),
4;case 158:return a=W(r(f.registerH,f.registerL)),Zb(a),4;case 159:return Zb(f.registerA),4}return-1}
function rc(a){switch(a){case 160:return $b(f.registerB),4;case 161:return $b(f.registerC),4;case 162:return $b(f.registerD),4;case 163:return $b(f.registerE),4;case 164:return $b(f.registerH),4;case 165:return $b(f.registerL),4;case 166:return a=W(r(f.registerH,f.registerL)),$b(a),4;case 167:return $b(f.registerA),4;case 168:return ac(f.registerB),4;case 169:return ac(f.registerC),4;case 170:return ac(f.registerD),4;case 171:return ac(f.registerE),4;case 172:return ac(f.registerH),4;case 173:return ac(f.registerL),
4;case 174:return a=W(r(f.registerH,f.registerL)),ac(a),4;case 175:return ac(f.registerA),4}return-1}
function sc(a){switch(a){case 176:return bc(f.registerB),4;case 177:return bc(f.registerC),4;case 178:return bc(f.registerD),4;case 179:return bc(f.registerE),4;case 180:return bc(f.registerH),4;case 181:return bc(f.registerL),4;case 182:return a=W(r(f.registerH,f.registerL)),bc(a),4;case 183:return bc(f.registerA),4;case 184:return cc(f.registerB),4;case 185:return cc(f.registerC),4;case 186:return cc(f.registerD),4;case 187:return cc(f.registerE),4;case 188:return cc(f.registerH),4;case 189:return cc(f.registerL),
4;case 190:return a=W(r(f.registerH,f.registerL)),cc(a),4;case 191:return cc(f.registerA),4}return-1}
function tc(a){switch(a){case 192:return 0===wa()?(a=f.stackPointer,f.programCounter=zc(a),f.stackPointer=a+2&65535,12):8;case 193:return a=zc(f.stackPointer),f.stackPointer=f.stackPointer+2&65535,f.registerB=t(a),f.registerC=a&255,4;case 194:if(0===wa())return f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;case 195:return f.programCounter=Bc(),8;case 196:if(0===wa())return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter+2&65535),f.programCounter=Bc(),
8;f.programCounter=f.programCounter+2&65535;return 12;case 197:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,r(f.registerB,f.registerC)),8;case 198:return Wb(Z()),f.programCounter=f.programCounter+1&65535,4;case 199:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=0,8;case 200:return 1===wa()?(a=f.stackPointer,f.programCounter=zc(a),f.stackPointer=a+2&65535,12):8;case 201:return a=f.stackPointer,f.programCounter=zc(a),f.stackPointer=a+2&65535,8;case 202:if(1===
wa())return f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;case 203:var b=Z();a=-1;var d=!1,g=0,h=0,w=b&7;switch(w){case 0:g=f.registerB;break;case 1:g=f.registerC;break;case 2:g=f.registerD;break;case 3:g=f.registerE;break;case 4:g=f.registerH;break;case 5:g=f.registerL;break;case 6:g=W(r(f.registerH,f.registerL));break;case 7:g=f.registerA}var A=(b&240)>>4;switch(A){case 0:7>=b?(b=g,n(128===(b&128)),b=(b<<1|b>>7)&255,k(0===b),l(0),m(0),h=b,d=!0):15>=b&&(b=g,n(0<(b&1)),
b=(b>>1|b<<7)&255,k(0===b),l(0),m(0),h=b,d=!0);break;case 1:23>=b?(b=g,d=128===(b&128),b=(b<<1|xa())&255,n(d),k(0===b),l(0),m(0),h=b,d=!0):31>=b&&(b=g,d=1===(b&1),b=(b>>1|xa()<<7)&255,n(d),k(0===b),l(0),m(0),h=b,d=!0);break;case 2:39>=b?(b=g,d=128===(b&128),b=b<<1&255,n(d),k(0===b),l(0),m(0),h=b,d=!0):47>=b&&(b=g,d=128===(b&128),g=1===(b&1),b=b>>1&255,d&&(b|=128),k(0===b),l(0),m(0),n(g),h=b,d=!0);break;case 3:55>=b?(b=g,b=((b&15)<<4|(b&240)>>4)&255,k(0===b),l(0),m(0),n(0),h=b,d=!0):63>=b&&(b=g,d=
1===(b&1),b=b>>1&255,k(0===b),l(0),m(0),n(d),h=b,d=!0);break;case 4:71>=b?(h=dc(0,g),d=!0):79>=b&&(h=dc(1,g),d=!0);break;case 5:87>=b?(h=dc(2,g),d=!0):95>=b&&(h=dc(3,g),d=!0);break;case 6:103>=b?(h=dc(4,g),d=!0):111>=b&&(h=dc(5,g),d=!0);break;case 7:119>=b?(h=dc(6,g),d=!0):127>=b&&(h=dc(7,g),d=!0);break;case 8:135>=b?(h=ec(0,0,g),d=!0):143>=b&&(h=ec(1,0,g),d=!0);break;case 9:151>=b?(h=ec(2,0,g),d=!0):159>=b&&(h=ec(3,0,g),d=!0);break;case 10:167>=b?(h=ec(4,0,g),d=!0):175>=b&&(h=ec(5,0,g),d=!0);break;
case 11:183>=b?(h=ec(6,0,g),d=!0):191>=b&&(h=ec(7,0,g),d=!0);break;case 12:199>=b?(h=ec(0,1,g),d=!0):207>=b&&(h=ec(1,1,g),d=!0);break;case 13:215>=b?(h=ec(2,1,g),d=!0):223>=b&&(h=ec(3,1,g),d=!0);break;case 14:231>=b?(h=ec(4,1,g),d=!0):239>=b&&(h=ec(5,1,g),d=!0);break;case 15:247>=b?(h=ec(6,1,g),d=!0):255>=b&&(h=ec(7,1,g),d=!0)}switch(w){case 0:f.registerB=h;break;case 1:f.registerC=h;break;case 2:f.registerD=h;break;case 3:f.registerE=h;break;case 4:f.registerH=h;break;case 5:f.registerL=h;break;
case 6:(4>A||7<A)&&yc(r(f.registerH,f.registerL),h);break;case 7:f.registerA=h}d&&(a=4);f.programCounter=f.programCounter+1&65535;return a;case 204:if(1===wa())return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter+2),f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;case 205:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter+2&65535),f.programCounter=Bc(),8;case 206:return Xb(Z()),f.programCounter=f.programCounter+1&65535,4;case 207:return a=
f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=8}return-1}
function uc(a){switch(a){case 208:return 0===xa()?(a=f.stackPointer,f.programCounter=zc(a),f.stackPointer=a+2&65535,12):8;case 209:a=f.stackPointer;var b=zc(a);f.stackPointer=a+2&65535;f.registerD=t(b);f.registerE=b&255;return 4;case 210:if(0===xa())return f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;case 212:if(0===xa())return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter+2),f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;
case 213:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,r(f.registerD,f.registerE)),8;case 214:return Yb(Z()),f.programCounter=f.programCounter+1&65535,4;case 215:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=16,8;case 216:return 1===xa()?(a=f.stackPointer,f.programCounter=zc(a),f.stackPointer=a+2&65535,12):8;case 217:return a=f.stackPointer,f.programCounter=zc(a),xb(!0),f.stackPointer=a+2&65535,8;case 218:if(1===xa())return f.programCounter=Bc(),
8;f.programCounter=f.programCounter+2&65535;return 12;case 220:if(1===xa())return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter+2&65535),f.programCounter=Bc(),8;f.programCounter=f.programCounter+2&65535;return 12;case 222:return Zb(Z()),f.programCounter=f.programCounter+1&65535,4;case 223:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=24,8}return-1}
function vc(a){switch(a){case 224:return a=Z(),yc(65280+a,f.registerA),f.programCounter=f.programCounter+1&65535,4;case 225:a=f.stackPointer;var b=zc(a);f.stackPointer=a+2&65535;f.registerH=t(b);f.registerL=b&255;return 4;case 226:return yc(65280+f.registerC,f.registerA),4;case 229:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,r(f.registerH,f.registerL)),8;case 230:return $b(Z()),f.programCounter=f.programCounter+1&65535,4;case 231:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),
f.programCounter=32,8;case 232:return a=Z()<<24>>24,Aa(f.stackPointer,a,!0),f.stackPointer=f.stackPointer+a&65535,k(0),l(0),f.programCounter=f.programCounter+1&65535,12;case 233:return f.programCounter=r(f.registerH,f.registerL),4;case 234:return yc(Bc(),f.registerA),f.programCounter=f.programCounter+2&65535,4;case 238:return ac(Z()),f.programCounter=f.programCounter+1&65535,4;case 239:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=40,8}return-1}
function wc(a){switch(a){case 240:return a=Z(),f.registerA=W(65280+a)&255,f.programCounter=f.programCounter+1&65535,4;case 241:a=f.stackPointer;var b=zc(a);f.stackPointer=a+2&65535;f.registerA=t(b);f.registerF=b&255;return 4;case 242:return f.registerA=W(65280+f.registerC)&255,4;case 243:return xb(!1),4;case 245:return a=f.stackPointer-2&65535,f.stackPointer=a,Ac(a,r(f.registerA,f.registerF)),8;case 246:return bc(Z()),f.programCounter=f.programCounter+1&65535,4;case 247:return a=f.stackPointer-2&
65535,f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=48,8;case 248:return b=Z()<<24>>24,a=f.stackPointer,k(0),l(0),Aa(a,b,!0),a=a+b&65535,f.registerH=t(a),f.registerL=a&255,f.programCounter=f.programCounter+1&65535,8;case 249:return f.stackPointer=r(f.registerH,f.registerL),8;case 250:return f.registerA=W(Bc()),f.programCounter=f.programCounter+2&65535,4;case 251:return xb(!0),4;case 254:return cc(Z()),f.programCounter=f.programCounter+1&65535,4;case 255:return a=f.stackPointer-2&65535,
f.stackPointer=a,Ac(a,f.programCounter),f.programCounter=56,8}return-1}var Cc=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=0;return a}();
function xc(a){0<U.DMACycles&&(a+=U.DMACycles,U.DMACycles=0);f.currentCycles+=a;if(!f.isStopped){if(e.graphicsBatchProcessing){D.currentCycles+=a;for(var b=D.batchProcessCycles();D.currentCycles>=b;)Sb(b),D.currentCycles-=b}else Sb(a);e.audioBatchProcessing?(E.currentCycles+=a,pb()):qb(a);b=a;if(Eb.transferStartFlag)for(var d=0;d<b;){var g=Eb.currentCycles,h=g;d+=4;h+=4;65535<h&&(h-=65536);Eb.currentCycles=h;var w=Eb.isClockSpeedFast?2:7;x(w,g)&&!x(w,h)&&(g=Eb.memoryLocationSerialTransferData,h=B(g),
h=(h<<1)+1,h&=255,G(g,h),g=Eb.numberOfBitsTransferred,8===++g?(Eb.numberOfBitsTransferred=0,Q.isSerialInterruptRequested=!0,yb(Q.bitPositionSerialInterrupt),g=Eb.memoryLocationSerialTransferControl,h=B(g),G(g,u(7,h)),Eb.transferStartFlag=!1):Eb.numberOfBitsTransferred=g)}}e.timersBatchProcessing?(S.currentCycles+=a,Db(S.currentCycles),S.currentCycles=0):Db(a);b=Cc.cycles;b+=a;b>=Cc.cyclesPerCycleSet&&(Cc.cycleSets+=1,b-=Cc.cyclesPerCycleSet);Cc.cycles=b}
var Dc=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();function Ec(){return Fc(!0,-1)}
function Fc(a,b){void 0===b&&(b=-1);a=1024;0<b?a=b:0>b&&(a=-1);for(var d=!1,g=!1,h=!1;!(d||g||h||Nb.reachedBreakpoint);)b=Gc(),0>b?d=!0:f.currentCycles>=f.MAX_CYCLES_PER_FRAME()?g=!0:-1<a&&tb()>=a&&(h=!0);if(g)return f.currentCycles-=f.MAX_CYCLES_PER_FRAME(),Dc.RESPONSE_CONDITION_FRAME;if(h)return Dc.RESPONSE_CONDITION_AUDIO;if(Nb.reachedBreakpoint)return Nb.reachedBreakpoint=!1,Dc.RESPONSE_CONDITION_BREAKPOINT;f.programCounter=f.programCounter-1&65535;return-1}
function Gc(){Hc=!0;if(f.isHaltBug){var a=B(f.programCounter);a=gc(a);xc(a);f.exitHaltAndStop()}Q.masterInterruptSwitchDelay&&(Q.masterInterruptSwitch=!0,Q.masterInterruptSwitchDelay=!1);if(0<(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)){a=!1;Q.masterInterruptSwitch&&!f.isHaltNoJump&&(Q.isVBlankInterruptEnabled&&Q.isVBlankInterruptRequested?(wb(Q.bitPositionVBlankInterrupt),a=!0):Q.isLcdInterruptEnabled&&Q.isLcdInterruptRequested?(wb(Q.bitPositionLcdInterrupt),a=!0):Q.isTimerInterruptEnabled&&
Q.isTimerInterruptRequested?(wb(Q.bitPositionTimerInterrupt),a=!0):Q.isSerialInterruptEnabled&&Q.isSerialInterruptRequested?(wb(Q.bitPositionSerialInterrupt),a=!0):Q.isJoypadInterruptEnabled&&Q.isJoypadInterruptRequested&&(wb(Q.bitPositionJoypadInterrupt),a=!0));var b=0;a&&(b=20,f.isHalted()&&(f.exitHaltAndStop(),b+=4));f.isHalted()&&f.exitHaltAndStop();a=b}else a=0;0<a&&xc(a);a=4;f.isHalted()||f.isStopped||(a=B(f.programCounter),a=gc(a));f.registerF&=240;if(0>=a)return a;xc(a);b=Dc.steps;b+=1;b>=
Dc.stepsPerStepSet&&(Dc.stepSets+=1,b-=Dc.stepsPerStepSet);Dc.steps=b;f.programCounter===Nb.programCounter&&(Nb.reachedBreakpoint=!0);return a}aa.size()<ua&&aa.grow(ua-aa.size());
var Hc=!1,Ic=Object.freeze({memory:aa,config:function(a,b,d,g,h,w,A,z,v,y){e.enableBootRom=0<a;e.useGbcWhenAvailable=0<b;e.audioBatchProcessing=0<d;e.graphicsBatchProcessing=0<g;e.timersBatchProcessing=0<h;e.graphicsDisableScanlineRendering=0<w;e.audioAccumulateSamples=0<A;e.tileRendering=0<z;e.tileCaching=0<v;e.enableAudioDebugging=0<y;a=B(323);f.GBCEnabled=192===a||e.useGbcWhenAvailable&&128===a?!0:!1;Hc=!1;Cc.cyclesPerCycleSet=2E9;Cc.cycleSets=0;Cc.cycles=0;Dc.stepsPerStepSet=2E9;Dc.stepSets=0;
Dc.steps=0;f.BootROMEnabled=e.enableBootRom?!0:!1;f.GBCDoubleSpeed=!1;f.registerA=0;f.registerB=0;f.registerC=0;f.registerD=0;f.registerE=0;f.registerH=0;f.registerL=0;f.registerF=0;f.stackPointer=0;f.programCounter=0;f.currentCycles=0;f.isHaltNormal=!1;f.isHaltNoJump=!1;f.isHaltBug=!1;f.isStopped=!1;f.BootROMEnabled||(f.GBCEnabled?(f.registerA=17,f.registerF=128,f.registerB=0,f.registerC=0,f.registerD=255,f.registerE=86,f.registerH=0,f.registerL=13):(f.registerA=1,f.registerF=176,f.registerB=0,f.registerC=
19,f.registerD=0,f.registerE=216,f.registerH=1,f.registerL=77),f.programCounter=256,f.stackPointer=65534);U.isRamBankingEnabled=!1;U.isMBC1RomModeEnabled=!0;a=B(327);U.isRomOnly=0===a;U.isMBC1=1<=a&&3>=a;U.isMBC2=5<=a&&6>=a;U.isMBC3=15<=a&&19>=a;U.isMBC5=25<=a&&30>=a;U.currentRomBank=1;U.currentRamBank=0;G(U.memoryLocationGBCVRAMBank,0);G(U.memoryLocationGBCWRAMBank,1);G(65361,255);G(65362,255);G(65363,255);G(65364,255);G(65365,255);D.currentCycles=0;D.scanlineCycleCounter=0;D.scanlineRegister=0;
D.scrollX=0;D.scrollY=0;D.windowX=0;D.windowY=0;D.scanlineRegister=144;f.GBCEnabled?(G(65345,129),G(65348,144),G(65351,252)):(G(65345,133),G(65350,255),G(65351,252),G(65352,255),G(65353,255));D.scanlineRegister=144;G(65344,145);G(65359,0);G(65392,1);f.BootROMEnabled&&(f.GBCEnabled?(D.scanlineRegister=0,G(65344,0),G(65345,128),G(65348,0)):(D.scanlineRegister=0,G(65344,0),G(65345,132)));ab(0);if(!f.GBCEnabled&&(!f.BootROMEnabled||f.GBCEnabled)){a=0;for(b=308;323>=b;b++)a+=B(b);switch(a&255){case 136:q.bgWhite=
Pa.bgWhite;q.bgLightGrey=Pa.bgLightGrey;q.bgDarkGrey=Pa.bgDarkGrey;q.bgBlack=Pa.bgBlack;q.obj0White=Pa.obj0White;q.obj0LightGrey=Pa.obj0LightGrey;q.obj0DarkGrey=Pa.obj0DarkGrey;q.obj0Black=Pa.obj0Black;q.obj1White=Pa.obj1White;q.obj1LightGrey=Pa.obj1LightGrey;q.obj1DarkGrey=Pa.obj1DarkGrey;q.obj1Black=Pa.obj1Black;break;case 97:q.bgWhite=Qa.bgWhite;q.bgLightGrey=Qa.bgLightGrey;q.bgDarkGrey=Qa.bgDarkGrey;q.bgBlack=Qa.bgBlack;q.obj0White=Qa.obj0White;q.obj0LightGrey=Qa.obj0LightGrey;q.obj0DarkGrey=
Qa.obj0DarkGrey;q.obj0Black=Qa.obj0Black;q.obj1White=Qa.obj1White;q.obj1LightGrey=Qa.obj1LightGrey;q.obj1DarkGrey=Qa.obj1DarkGrey;q.obj1Black=Qa.obj1Black;break;case 20:q.bgWhite=Ra.bgWhite;q.bgLightGrey=Ra.bgLightGrey;q.bgDarkGrey=Ra.bgDarkGrey;q.bgBlack=Ra.bgBlack;q.obj0White=Ra.obj0White;q.obj0LightGrey=Ra.obj0LightGrey;q.obj0DarkGrey=Ra.obj0DarkGrey;q.obj0Black=Ra.obj0Black;q.obj1White=Ra.obj1White;q.obj1LightGrey=Ra.obj1LightGrey;q.obj1DarkGrey=Ra.obj1DarkGrey;q.obj1Black=Ra.obj1Black;break;
case 70:q.bgWhite=Sa.bgWhite;q.bgLightGrey=Sa.bgLightGrey;q.bgDarkGrey=Sa.bgDarkGrey;q.bgBlack=Sa.bgBlack;q.obj0White=Sa.obj0White;q.obj0LightGrey=Sa.obj0LightGrey;q.obj0DarkGrey=Sa.obj0DarkGrey;q.obj0Black=Sa.obj0Black;q.obj1White=Sa.obj1White;q.obj1LightGrey=Sa.obj1LightGrey;q.obj1DarkGrey=Sa.obj1DarkGrey;q.obj1Black=Sa.obj1Black;break;case 89:case 198:q.bgWhite=Ta.bgWhite;q.bgLightGrey=Ta.bgLightGrey;q.bgDarkGrey=Ta.bgDarkGrey;q.bgBlack=Ta.bgBlack;q.obj0White=Ta.obj0White;q.obj0LightGrey=Ta.obj0LightGrey;
q.obj0DarkGrey=Ta.obj0DarkGrey;q.obj0Black=Ta.obj0Black;q.obj1White=Ta.obj1White;q.obj1LightGrey=Ta.obj1LightGrey;q.obj1DarkGrey=Ta.obj1DarkGrey;q.obj1Black=Ta.obj1Black;break;case 134:case 168:q.bgWhite=Ua.bgWhite;q.bgLightGrey=Ua.bgLightGrey;q.bgDarkGrey=Ua.bgDarkGrey;q.bgBlack=Ua.bgBlack;q.obj0White=Ua.obj0White;q.obj0LightGrey=Ua.obj0LightGrey;q.obj0DarkGrey=Ua.obj0DarkGrey;q.obj0Black=Ua.obj0Black;q.obj1White=Ua.obj1White;q.obj1LightGrey=Ua.obj1LightGrey;q.obj1DarkGrey=Ua.obj1DarkGrey;q.obj1Black=
Ua.obj1Black;break;case 191:case 206:case 209:case 240:q.bgWhite=Va.bgWhite;q.bgLightGrey=Va.bgLightGrey;q.bgDarkGrey=Va.bgDarkGrey;q.bgBlack=Va.bgBlack;q.obj0White=Va.obj0White;q.obj0LightGrey=Va.obj0LightGrey;q.obj0DarkGrey=Va.obj0DarkGrey;q.obj0Black=Va.obj0Black;q.obj1White=Va.obj1White;q.obj1LightGrey=Va.obj1LightGrey;q.obj1DarkGrey=Va.obj1DarkGrey;q.obj1Black=Va.obj1Black;break;case 39:case 73:case 92:case 179:q.bgWhite=Wa.bgWhite;q.bgLightGrey=Wa.bgLightGrey;q.bgDarkGrey=Wa.bgDarkGrey;q.bgBlack=
Wa.bgBlack;q.obj0White=Wa.obj0White;q.obj0LightGrey=Wa.obj0LightGrey;q.obj0DarkGrey=Wa.obj0DarkGrey;q.obj0Black=Wa.obj0Black;q.obj1White=Wa.obj1White;q.obj1LightGrey=Wa.obj1LightGrey;q.obj1DarkGrey=Wa.obj1DarkGrey;q.obj1Black=Wa.obj1Black;break;case 201:q.bgWhite=Xa.bgWhite;q.bgLightGrey=Xa.bgLightGrey;q.bgDarkGrey=Xa.bgDarkGrey;q.bgBlack=Xa.bgBlack;q.obj0White=Xa.obj0White;q.obj0LightGrey=Xa.obj0LightGrey;q.obj0DarkGrey=Xa.obj0DarkGrey;q.obj0Black=Xa.obj0Black;q.obj1White=Xa.obj1White;q.obj1LightGrey=
Xa.obj1LightGrey;q.obj1DarkGrey=Xa.obj1DarkGrey;q.obj1Black=Xa.obj1Black;break;case 112:q.bgWhite=Ya.bgWhite;q.bgLightGrey=Ya.bgLightGrey;q.bgDarkGrey=Ya.bgDarkGrey;q.bgBlack=Ya.bgBlack;q.obj0White=Ya.obj0White;q.obj0LightGrey=Ya.obj0LightGrey;q.obj0DarkGrey=Ya.obj0DarkGrey;q.obj0Black=Ya.obj0Black;q.obj1White=Ya.obj1White;q.obj1LightGrey=Ya.obj1LightGrey;q.obj1DarkGrey=Ya.obj1DarkGrey;q.obj1Black=Ya.obj1Black;break;case 70:q.bgWhite=Za.bgWhite;q.bgLightGrey=Za.bgLightGrey;q.bgDarkGrey=Za.bgDarkGrey;
q.bgBlack=Za.bgBlack;q.obj0White=Za.obj0White;q.obj0LightGrey=Za.obj0LightGrey;q.obj0DarkGrey=Za.obj0DarkGrey;q.obj0Black=Za.obj0Black;q.obj1White=Za.obj1White;q.obj1LightGrey=Za.obj1LightGrey;q.obj1DarkGrey=Za.obj1DarkGrey;q.obj1Black=Za.obj1Black;break;case 211:q.bgWhite=$a.bgWhite,q.bgLightGrey=$a.bgLightGrey,q.bgDarkGrey=$a.bgDarkGrey,q.bgBlack=$a.bgBlack,q.obj0White=$a.obj0White,q.obj0LightGrey=$a.obj0LightGrey,q.obj0DarkGrey=$a.obj0DarkGrey,q.obj0Black=$a.obj0Black,q.obj1White=$a.obj1White,
q.obj1LightGrey=$a.obj1LightGrey,q.obj1DarkGrey=$a.obj1DarkGrey,q.obj1Black=$a.obj1Black}}f.GBCEnabled?(G(65384,192),G(65385,255),G(65386,193),G(65387,13)):(G(65384,255),G(65385,255),G(65386,255),G(65387,255));f.BootROMEnabled&&f.GBCEnabled&&(G(65385,32),G(65387,138));E.currentCycles=0;E.NR50LeftMixerVolume=0;E.NR50RightMixerVolume=0;E.NR51IsChannel1EnabledOnLeftOutput=!0;E.NR51IsChannel2EnabledOnLeftOutput=!0;E.NR51IsChannel3EnabledOnLeftOutput=!0;E.NR51IsChannel4EnabledOnLeftOutput=!0;E.NR51IsChannel1EnabledOnRightOutput=
!0;E.NR51IsChannel2EnabledOnRightOutput=!0;E.NR51IsChannel3EnabledOnRightOutput=!0;E.NR51IsChannel4EnabledOnRightOutput=!0;E.NR52IsSoundEnabled=!0;E.frameSequenceCycleCounter=0;E.downSampleCycleCounter=0;E.frameSequencer=0;E.audioQueueIndex=0;I.initialize();M.initialize();N.initialize();O.initialize();G(E.memoryLocationNR50,119);E.updateNR50(119);G(E.memoryLocationNR51,243);E.updateNR51(243);G(E.memoryLocationNR52,241);E.updateNR52(241);f.BootROMEnabled&&(G(E.memoryLocationNR50,0),E.updateNR50(0),
G(E.memoryLocationNR51,0),E.updateNR51(0),G(E.memoryLocationNR52,112),E.updateNR52(112));P.channel1Sample=15;P.channel2Sample=15;P.channel3Sample=15;P.channel4Sample=15;P.channel1DacEnabled=!1;P.channel2DacEnabled=!1;P.channel3DacEnabled=!1;P.channel4DacEnabled=!1;P.leftChannelSampleUnsignedByte=127;P.rightChannelSampleUnsignedByte=127;P.mixerVolumeChanged=!0;P.mixerEnabledChanged=!0;P.needToRemixSamples=!1;Q.updateInterruptEnabled(0);G(Q.memoryLocationInterruptEnabled,Q.interruptsEnabledValue);Q.updateInterruptRequested(225);
G(Q.memoryLocationInterruptRequest,Q.interruptsRequestedValue);S.currentCycles=0;S.dividerRegister=0;S.timerCounter=0;S.timerModulo=0;S.timerEnabled=!1;S.timerInputClock=0;S.timerCounterOverflowDelay=!1;S.timerCounterWasReset=!1;f.GBCEnabled?(G(65284,30),S.dividerRegister=7840):(G(65284,171),S.dividerRegister=43980);G(65287,248);S.timerInputClock=248;f.BootROMEnabled&&!f.GBCEnabled&&(G(65284,0),S.dividerRegister=4);Eb.currentCycles=0;Eb.numberOfBitsTransferred=0;f.GBCEnabled?(G(65282,124),Eb.updateTransferControl(124)):
(G(65282,126),Eb.updateTransferControl(126));f.GBCEnabled?(G(65392,248),G(65359,254),G(65357,126),G(65280,207),G(65295,225),G(65388,254),G(65397,143)):(G(65392,255),G(65359,255),G(65357,255),G(65280,207),G(65295,225))},hasCoreStarted:function(){return Hc},saveState:function(){f.saveState();D.saveState();Q.saveState();T.saveState();U.saveState();S.saveState();E.saveState();I.saveState();M.saveState();N.saveState();O.saveState();Hc=!1},loadState:function(){f.loadState();D.loadState();Q.loadState();
T.loadState();U.loadState();S.loadState();E.loadState();I.loadState();M.loadState();N.loadState();O.loadState();Hc=!1;Cc.cyclesPerCycleSet=2E9;Cc.cycleSets=0;Cc.cycles=0;Dc.stepsPerStepSet=2E9;Dc.stepSets=0;Dc.steps=0},isGBC:function(){return f.GBCEnabled},getStepsPerStepSet:function(){return Dc.stepsPerStepSet},getStepSets:function(){return Dc.stepSets},getSteps:function(){return Dc.steps},executeMultipleFrames:function(a){for(var b=0,d=0;d<a&&0<=b;)b=Ec(),d+=1;return 0>b?b:0},executeFrame:Ec,executeFrameAndCheckAudio:function(a){void 0===
a&&(a=0);return Fc(!0,a)},executeUntilCondition:Fc,executeStep:Gc,getCyclesPerCycleSet:function(){return Cc.cyclesPerCycleSet},getCycleSets:function(){return Cc.cycleSets},getCycles:function(){return Cc.cycles},setJoypadState:function(a,b,d,g,h,w,A,z){0<a?Fb(0):Hb(0,!1);0<b?Fb(1):Hb(1,!1);0<d?Fb(2):Hb(2,!1);0<g?Fb(3):Hb(3,!1);0<h?Fb(4):Hb(4,!1);0<w?Fb(5):Hb(5,!1);0<A?Fb(6):Hb(6,!1);0<z?Fb(7):Hb(7,!1)},getNumberOfSamplesInAudioBuffer:tb,clearAudioBuffer:ob,setManualColorizationPalette:ab,WASMBOY_MEMORY_LOCATION:0,
WASMBOY_MEMORY_SIZE:ta,WASMBOY_WASM_PAGES:ua,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,GAMEBOY_INTERNAL_MEMORY_SIZE:ba,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:ca,GRAPHICS_OUTPUT_SIZE:ja,GBC_PALETTE_LOCATION:ca,GBC_PALETTE_SIZE:128,
BG_PRIORITY_MAP_LOCATION:da,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:ea,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:fa,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:ha,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:ia,OAM_TILES_SIZE:15360,AUDIO_BUFFER_LOCATION:oa,AUDIO_BUFFER_SIZE:131072,CHANNEL_1_BUFFER_LOCATION:ka,CHANNEL_1_BUFFER_SIZE:131072,CHANNEL_2_BUFFER_LOCATION:la,CHANNEL_2_BUFFER_SIZE:131072,CHANNEL_3_BUFFER_LOCATION:ma,CHANNEL_3_BUFFER_SIZE:131072,CHANNEL_4_BUFFER_LOCATION:na,CHANNEL_4_BUFFER_SIZE:131072,
CARTRIDGE_RAM_LOCATION:pa,CARTRIDGE_RAM_SIZE:131072,BOOT_ROM_LOCATION:qa,BOOT_ROM_SIZE:2560,CARTRIDGE_ROM_LOCATION:ra,CARTRIDGE_ROM_SIZE:8258560,DEBUG_GAMEBOY_MEMORY_LOCATION:sa,DEBUG_GAMEBOY_MEMORY_SIZE:65535,getWasmBoyOffsetFromGameBoyOffset:Mb,setProgramCounterBreakpoint:function(a){Nb.programCounter=a},resetProgramCounterBreakpoint:function(){Nb.programCounter=-1},setReadGbMemoryBreakpoint:function(a){Nb.readGbMemory=a},resetReadGbMemoryBreakpoint:function(){Nb.readGbMemory=-1},setWriteGbMemoryBreakpoint:function(a){Nb.writeGbMemory=
a},resetWriteGbMemoryBreakpoint:function(){Nb.writeGbMemory=-1},getRegisterA:function(){return f.registerA},getRegisterB:function(){return f.registerB},getRegisterC:function(){return f.registerC},getRegisterD:function(){return f.registerD},getRegisterE:function(){return f.registerE},getRegisterH:function(){return f.registerH},getRegisterL:function(){return f.registerL},getRegisterF:function(){return f.registerF},getProgramCounter:function(){return f.programCounter},getStackPointer:function(){return f.stackPointer},
getOpcodeAtProgramCounter:function(){return B(f.programCounter)},getLY:function(){return D.scanlineRegister},getScrollX:function(){return D.scrollX},getScrollY:function(){return D.scrollY},getWindowX:function(){return D.windowX},getWindowY:function(){return D.windowY},drawBackgroundMapToWasmMemory:function(a){var b=D.memoryLocationTileDataSelectZeroStart;V.bgWindowTileDataSelect&&(b=D.memoryLocationTileDataSelectOneStart);var d=D.memoryLocationTileMapSelectZeroStart;V.bgTileMapDisplaySelect&&(d=D.memoryLocationTileMapSelectOneStart);
for(var g=0;256>g;g++)for(var h=0;256>h;h++){var w=g,A=h,z=d+32*(w>>3)+(A>>3),v=kb(z,0);v=jb(b,v);var y=w%8;w=A%8;w=7-w;A=0;f.GBCEnabled&&0<a&&(A=kb(z,1));x(6,A)&&(y=7-y);var J=0;x(3,A)&&(J=1);z=kb(v+2*y,J);v=kb(v+2*y+1,J);y=0;x(w,v)&&(y+=1,y<<=1);x(w,z)&&(y+=1);v=3*(256*g+h);f.GBCEnabled&&0<a?(z=db(A&7,y,!1),A=fb(0,z),w=fb(1,z),z=fb(2,z),v=fa+v,c[v]=A,c[v+1]=w,c[v+2]=z):(A=cb(y,D.memoryLocationBackgroundPalette),v=fa+v,c[v+0]=(A&16711680)>>16,c[v+1]=(A&65280)>>8,c[v+2]=A&255)}},drawTileDataToWasmMemory:function(){for(var a=
0;23>a;a++)for(var b=0;31>b;b++){var d=0;15<b&&(d=1);var g=a;15<a&&(g-=15);g<<=4;g=15<b?g+(b-15):g+b;var h=D.memoryLocationTileDataSelectOneStart;15<a&&(h=D.memoryLocationTileDataSelectZeroStart);for(var w=D.memoryLocationBackgroundPalette,A=-1,z=-1,v=0;8>v;v++)for(var y=0;5>y;y++){var J=4*(8*y+v),C=B(D.memoryLocationSpriteAttributesTable+J+2);g===C&&(J=B(D.memoryLocationSpriteAttributesTable+J+3),C=0,f.GBCEnabled&&x(3,J)&&(C=1),C===d&&(z=J,v=8,y=5,w=D.memoryLocationSpritePaletteOne,x(4,z)&&(w=D.memoryLocationSpritePaletteTwo)))}if(f.GBCEnabled&&
0>z){v=D.memoryLocationTileMapSelectZeroStart;V.bgTileMapDisplaySelect&&(v=D.memoryLocationTileMapSelectOneStart);y=-1;for(J=0;32>J;J++)for(C=0;32>C;C++){var K=v+32*C+J,X=kb(K,0);g===X&&(y=K,C=J=32)}0<=y&&(A=kb(y,1))}for(v=0;8>v;v++)ib(g,h,d,0,7,v,8*b,8*a+v,248,ha,!1,w,A,z)}},drawOamToWasmMemory:function(){for(var a=0;8>a;a++)for(var b=0;5>b;b++){var d=4*(8*b+a);B(D.memoryLocationSpriteAttributesTable+d);B(D.memoryLocationSpriteAttributesTable+d+1);var g=B(D.memoryLocationSpriteAttributesTable+d+
2),h=1;V.tallSpriteSize&&(1===g%2&&--g,h+=1);d=B(D.memoryLocationSpriteAttributesTable+d+3);var w=0;f.GBCEnabled&&x(3,d)&&(w=1);var A=D.memoryLocationSpritePaletteOne;x(4,d)&&(A=D.memoryLocationSpritePaletteTwo);for(var z=0;z<h;z++)for(var v=0;8>v;v++)ib(g+z,D.memoryLocationTileDataSelectOneStart,w,0,7,v,8*a,16*b+v+8*z,64,ia,!1,A,-1,d)}},getDIV:function(){return S.dividerRegister},getTIMA:function(){return S.timerCounter},getTMA:function(){return S.timerModulo},getTAC:function(){var a=S.timerInputClock;
S.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>a;a++){var b=Jb(a);c[sa+a]=b}Nb.reachedBreakpoint=!1}});export default async()=>({instance:{exports:Ic},byteMemory:aa.wasmByteMemory,type:"TypeScript"})
//# sourceMappingURL=getWasmBoyTsCore.closure.esm.js.map
